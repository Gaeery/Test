
<html>
   <head>
      <style type="text/css">
         .sikuli-code {
            font-size: 20px;
            font-family: "Osaka-mono", Monospace;
            line-height: 1.5em;
            display:table-cell;
            white-space: pre-wrap;       /* css-3 */
            white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
            white-space: -pre-wrap;      /* Opera 4-6 */
            white-space: -o-pre-wrap;    /* Opera 7 */
            word-wrap: break-word;       /* Internet Explorer 5.5+ */
            width: 99%;   /* remove horizontal scroll-bar when viewing in IE7 */
         }
         .sikuli-code img {
            vertical-align: middle;
            margin: 2px;
            border: 1px solid #ccc;
            padding: 2px;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            -moz-box-shadow: 1px 1px 1px gray;
            -webkit-box-shadow: 1px 1px 2px gray;
         }
         .kw {
            color: blue;
         }
         .skw {
            color: rgb(63, 127, 127);
         }

         .str {
            color: rgb(128, 0, 0);
         }

         .dig {
            color: rgb(128, 64, 0);
         }

         .cmt {
            color: rgb(200, 0, 200);
         }

         h2 {
            display: inline;
            font-weight: normal;
         }

         .info {
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 20px;
            display: none;
         }

         a {
            color: #9D2900;
         }

         body {
            font-family: "Trebuchet MS", Arial, Sans-Serif;
         }

      </style>
   </head>
<body>
<div class="info">
<h2>japenesePractice.sikuli</h2> <a href="japenesePractice.zip">(Download this script)</a>
</div>
<pre class="sikuli-code">
<span class="kw">import</span> random
<span class="kw">import</span> ControlLib
<span class="kw">from</span> ControlLib <span class="kw">import</span> *
reload(ControlLib)  <span class="cmt"># make sure global variables are reloaded</span>
<span class="kw">import</span> SwordAndMagicPictures
reload(SwordAndMagicPictures)  <span class="cmt"># make sure global variables are reloaded</span>
<span class="kw">from</span> SwordAndMagicPictures <span class="kw">import</span> *
<span class="kw">import</span> SwordAndMagicActions
<span class="kw">from</span> SwordAndMagicActions <span class="kw">import</span> *
reload(SwordAndMagicActions)
<span class="kw">global</span> enumType

enumPractice = <span class="dig">1</span>
enumStoneMission = <span class="dig">2</span>
enumFixLocation = <span class="dig">3</span>
enumFixLocationTwice = <span class="dig">20</span>
enumFixLocationDropExp = <span class="dig">15</span>
enumFixLocationOtherServer = <span class="dig">4</span>
enumFixLocationSkip= <span class="dig">11</span>
enumMoveThanFind = <span class="dig">5</span>  <span class="cmt">#special first</span>
enumMoveThanFindSmall = <span class="dig">18</span>
enumIronMonster = <span class="dig">6</span>
enumAudoFindMonster = <span class="dig">7</span>
enumMoveALittle = <span class="dig">8</span>
enumMoveALittleAndFindFighting = <span class="dig">13</span>  <span class="cmt">#兔子</span>
enumEVP = <span class="dig">9</span>
enumEVP_branch = <span class="dig">14</span>
enumAutoSkill = <span class="dig">10</span>
enumArmorAngle = <span class="dig">16</span>
enumArmorAssassin = <span class="dig">23</span>
enumArmorMele = <span class="dig">19</span>
enumArmorWeekend = <span class="dig">17</span>
enumImageOffset = <span class="dig">21</span>
enumArmorHand = <span class="dig">22</span>

<span class="cmt">#-------------</span>
enumType = enumStoneMission
<span class="cmt">#enumType = enumMoveThanFind</span>
<span class="cmt">#enumType = enumImageOffset</span>
enumTypeNext = <span class="dig">99</span>

locationFixedMoveInMission =      Location(<span class="dig">332</span>, <span class="dig">644</span>)
locationFixedMoveInMission2 = Location(<span class="dig">513</span>, <span class="dig">443</span>)

<span class="cmt"># 技能使用</span>
autoKills = [<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">5</span>,<span class="dig">0</span>]  <span class="cmt">#火範圍 (Wind</span>

<span class="cmt">#autoKills = [2,1,4,3,5,0,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4]  #光補 (神劍</span>
<span class="cmt">#autoKills = [1,4,3,2,5,0,2]  #火範圍</span>
<span class="cmt">#autoKills = [1,3,5,0,4,2]  #火範圍 (血少怪</span>
<span class="cmt">#autoKills = [0,1,2,3,4,5,3,4,0,1,2,3,4]  #土範圍坦</span>
<span class="cmt">#autoKills = [4, 0, 1, -3, 3, 2, -2]  #坦 (2戰慄, 2復活)</span>
<span class="cmt">#autoKills = [4, 0, 1, -2, 3, 2, 5, 4, 0, 1, -2, 3, 2, -2]  #坦 (2戰慄, 2復活, 6武/2)</span>
<span class="cmt">#autoKills = [4, 1, 0, 2, -2, 5, 3]  #光坦 (1獄鬼)</span>
<span class="cmt">#autoKills = [4, 0, 1, -2, 3, 2, 5]  #坦 (2戰慄, 2復活, 6武)</span>
<span class="cmt">#autoKills = [0, 1, -2, 2, -2, 3, -2, 4] #補坦</span>
<span class="cmt">#水靈刀 </span>
autoKills = [<span class="dig">0</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,-<span class="dig">1</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>]
<span class="cmt">#autoKills = [5,0,1,2,3,4,5,3,4,-1,3,4,2,3,4,3,4,1,2,3,4,5,3,4,2,3,4,3,4,3,4,1,2,3,4,5,3,4,2,3,4,3,4,1,2,3,4,5,3,4,3,4,2,3,4,5,3,4,1,2,3,4,3,4]  </span>
<span class="cmt">#autoKills = [0,1,2,0,1,3,4,0,1,0,1,2,0,1,4,0,1,3,0,1,2,0,1,4,0,1,3]  #暗殺(雙獄鬼)</span>
<span class="cmt">#autoKills = [0,1,2,4,3,5,1,2,4,3,5]  #土單 (霸劍+血少</span>
<span class="cmt">#autoKills = [0,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4]  #土單 (霸劍</span>
<span class="cmt">#autoKills = [3,1,2,4,5,-1,0]  #土單 (無霸劍</span>


<span class="cmt">#autoKills = [0,1,2,3,5,4, 0,4,1,3,5,2,4,0,3,1,5,4,2,3,0,4]  #光evp</span>
<span class="cmt">#autoKills = [0,2,3,1,0,3,1]</span>

<span class="cmt">#autoKills = [4, 0, 1, -6, 3, 2]  #風坦</span>
<span class="cmt">#autoKills = [3, 1, 2, 0, 4, -7, 5, -7]  #水坦</span>
<span class="cmt">#autoKills = [4,3, 1, 0, 2, -3, 4, -8, 5, -8]  #坦2</span>
<span class="cmt">#autoKills = [2,0,1,3,2,2,1]  # PVP 水劍姬</span>
<span class="cmt">#autoKills = [0,1,1,1,1,1,1,1,1,1,1]  # PVP 水劍姬</span>
<span class="cmt">#autoKills = [3,5,0,2,1]  </span>
<span class="cmt">#autoKills = [0, -5, 1, -5, 2]  # 1~3 poison</span>
<span class="cmt">#autoKills = [3, 0, 1, 2 ,4,1] </span>
<span class="cmt">#autoKills = [4, 0, 1, 2,3,5] </span>
<span class="cmt">#autoKills = [0,1,5,3]   </span>
<span class="cmt">#autoKills = [3,0,4,2,1] #銀河</span>




moveToFightingSteps = Images( [ Pattern(<img src="imageOtherFighting2.png" />).similar(<span class="dig">0.95</span>).targetOffset(-<span class="dig">4</span>,<span class="dig">11</span>), Pattern(<img src="1515246341319.png" />).targetOffset(<span class="dig">0</span>,<span class="dig">7</span>), Pattern(<img src="1515825263702.png" />).similar(<span class="dig">0.80</span>).targetOffset(<span class="dig">8</span>,<span class="dig">5</span>), Pattern(<img src="1515939291635.png" />).similar(<span class="dig">0.90</span>).targetOffset(-<span class="dig">10</span>,<span class="dig">7</span>), Pattern(<img src="1516377416248.png" />).similar(<span class="dig">0.90</span>).targetOffset(-<span class="dig">11</span>,<span class="dig">8</span>), Pattern(<img src="1516502416160.png" />).targetOffset(-<span class="dig">18</span>,<span class="dig">7</span>), Pattern(<img src="1517135420431.png" />).targetOffset(<span class="dig">18</span>,<span class="dig">8</span>)] )
<span class="cmt">#moveToFightingSteps = Images( [ Pattern("1507897726703.png").similar(0.90).targetOffset(0,10), Pattern("imageOtherFighting.png").similar(0.85).targetOffset(0,7), Pattern("imageOtherFighting2.png").similar(0.90).targetOffset(0,7), Pattern("imageOtherFighting3.png").similar(0.75).targetOffset(0,4), Pattern("1503100614536.png").similar(0.75).targetOffset(0,8), Pattern("1503101128026.png").similar(0.75).targetOffset(0,6), Pattern("1503101630080.png").similar(0.75).targetOffset(0,7), Pattern("1508031407013.png").similar(0.66).targetOffset(0,5), Pattern("1515246341319.png").targetOffset(0,4), Pattern("1515825263702.png").similar(0.80).targetOffset(8,5), Pattern("1515939291635.png").similar(0.90).targetOffset(-10,7), Pattern("1516377416248.png").similar(0.90).targetOffset(-10,6), Pattern("1516502416160.png").targetOffset(-18,7)] )</span>



<span class="cmt"># move if bMoveOnceInMission</span>
bMoveOnceInMission = False

nMoveDelay = <span class="dig">5</span>
<span class="cmt"># move if bMoveTwiceInMission</span>
<span class="cmt">#locationFixedMoveInMission2 = locationWindBoss</span>
nMoveDelay2 = <span class="dig">1</span>
bMoveToFighting = True
<span class="cmt"># GPS buffer [ imageDoubleExp, imageDropIncrease, imageSpecialMonsterIncrease ] </span>
bUseGPS = True

bNeedToEnterEvpRoom = False
bNeedToBox = False
bLogingIn = False


fireMonster = <img src="imageMonster-2.png" />
windMonster = <img src="windMonster-1.png" />
soilMonster = <img src="soilMonster.png" />
waterMonster = <img src="waterMonster.png" />
ironMonster = <img src="1498839906365.png" />
darkMonster = <img src="darkMonster.png" />
<span class="cmt">#goldenMonster = </span>
imageOtherFighting_ = <img src="imageOtherFighting.png" />
<span class="cmt">#imageFightings = [ Pattern("1507897726703.png").similar(0.90), Pattern("imageOtherFighting.png").similar(0.85), Pattern("imageOtherFighting2.png").similar(0.90), Pattern("imageOtherFighting3.png").similar(0.75), Pattern("1503100614536.png").similar(0.75), Pattern("1503101128026.png").similar(0.75), Pattern("1503101630080.png").similar(0.75), "1503121487310.png", Pattern("1508031407013.png").similar(0.66), "1515246341319.png" ]</span>


imageDoubleExp = <img src="imageDoubleExp.png" />
imageDropIncrease = <img src="imageDropIncrease.png" />
imageSpecialMonsterIncrease = <img src="imageSpecialMonsterIncrease.png" />

<span class="cmt">#after fight</span>
imageAgain = <img src="imageAgain.png" />
<span class="cmt">#after getted gift</span>
imageAgain2 = <img src="imageAgain.png" />

imageNextPage = Pattern(<img src="1499126342274.png" />).similar(<span class="dig">0.98</span>)

imageNextPage1 = Pattern(<img src="imageNextPage1.png" />).similar(<span class="dig">0.97</span>)
imageNextPage2 = imageNextPage1
imageNextPage22 = Pattern(<img src="1499986887004.png" />).similar(<span class="dig">0.97</span>)

imageNextPage3 = <img src="imageNextPage3.png" />
imageOpenGift = <img src="imageOpenGift.png" />
imageAgree = Pattern(<img src="imageAgree.png" />).similar(<span class="dig">0.98</span>)
imageGo = <img src="imageGo.png" />

imageFriendMenu = <img src="imageFriendMenu.png" />
imagePageSelectingTask = <img src="imagePageSelectingTask.png" />
imagePageOpenGift = <img src="imagePageOpenGift.png" />
imageConsole = <img src="imageConsole.png" />


monsterRegion = monsterRegion_Full


locationMonster = Location(<span class="dig">84</span>, <span class="dig">557</span>)



locationDown = Location(<span class="dig">280</span>, <span class="dig">535</span>)
locationUp = Location(<span class="dig">280</span>, <span class="dig">515</span>)
nDelayBeforeUsingSkill = <span class="dig">0</span>

Settings.MoveMouseDelay = <span class="dig">0</span>
<span class="cmt"># ======== default值, 不要改這邊 =========</span>
<span class="cmt"># 自己找怪撞</span>
bFindMonsterBySelf = False
<span class="cmt"># 找任務目標的紅色箭頭</span>
bFindTargetInMission = False
<span class="cmt"># 找有人嘁王 (disposed)</span>
bBossMonsterFirst = False
<span class="cmt"># 先找Boss的圖</span>
bMoveToBoss = False
imageBoss = [ <img src="1502752920469.png" /> ]
<span class="cmt"># 怪的圖</span>
imageMonsters = [ <img src="1500760227483.png" />, <img src="1500760266200.png" /> ]

<span class="cmt">#need to move a step in mission</span>
<span class="cmt">#locationFixedMoveInMission = locationAssassin</span>
<span class="cmt">#need to move second step in mission</span>
bMoveTwiceInMission = False
<span class="cmt">#locationFixedMoveInMission2 = Location(335, 489)</span>
<span class="cmt"># 是否要移到別人的戰鬥中</span>


<span class="cmt"># 開禮物, True適用與各情況, False比較快</span>
bNeedOpenGift = True

imageBonus1 = imageSpecialMonsterIncrease
imageBonus2 = imageDropIncrease

<span class="cmt"># 需要選人少的分流?</span>
bNeedUseOtherBranchServer = False
<span class="cmt"># 戰鬥後, 位移一點</span>
bMoveALittleAfterFight = False

<span class="cmt"># let second character fly to join</span>
bSecondCharacterFlyToJoin = False
bCanEscap = True
nCheckFightingTimes = <span class="dig">1</span>
bNeedTransfer = False
imageMissions = []
bNeedSayThanks = False


<span class="cmt"># ======== 需換的部分 ===============================================================</span>

<span class="cmt">#imageMonster = locationWindBoss</span>


<span class="cmt">#優先高的放後面, 或第一個</span>
<span class="cmt">#autoKills = [3,5,4,0,2,1]</span>
<span class="cmt">#autoKills = [2,5,0,1,3,4]</span>
<span class="cmt">#autoKills = [0,1,2,3,4]</span>
monsterPositions = [Location(<span class="dig">439</span>, <span class="dig">328</span>),
        Location(<span class="dig">364</span>, <span class="dig">651</span>),   <span class="cmt">#泳裝1F</span>
        Location(<span class="dig">366</span>, <span class="dig">682</span>),  <span class="cmt">#舊寶石任</span>
        Location(<span class="dig">369</span>, <span class="dig">612</span>),
        Location(<span class="dig">460</span>, <span class="dig">603</span>),  <span class="cmt">#光試煉小怪</span>
        <span class="cmt">#Location(379, 504), #light boss</span>
        <span class="cmt">#Location(337, 514), #wind boss</span>
        <span class="cmt">#Location(442, 530), #mud practice</span>
        Location(<span class="dig">463</span>, <span class="dig">558</span>), <span class="cmt">#地瓜頂</span>
        Location(<span class="dig">369</span>, <span class="dig">502</span>), <span class="cmt">#protector</span>
        Location(<span class="dig">385</span>, <span class="dig">456</span>),  <span class="cmt">#新寶石任, 生命氣息</span>
        Location(<span class="dig">399</span>, <span class="dig">557</span>), <span class="cmt">#泳裝</span>
        Location(<span class="dig">438</span>, <span class="dig">450</span>), <span class="cmt">#EVP, 洗腦</span>
        Location(<span class="dig">443</span>, <span class="dig">539</span>), <span class="cmt">#火小怪</span>
        <span class="cmt">#Location(457, 603),</span>
        Location(<span class="dig">279</span>, <span class="dig">671</span>),
        Location(<span class="dig">289</span>, <span class="dig">514</span>),
        Location(<span class="dig">302</span>, <span class="dig">372</span>),
        Location(<span class="dig">379</span>, <span class="dig">522</span>)
        ]
<span class="cmt"># click skip before mission</span>
bNeedSkip = False
<span class="cmt"># click skip after mission</span>
bSkipBeforeAgain = False

bNeedAgree = True

<span class="cmt"># maximun time to stay in a mission.  (0: disable)</span>
nMaximunMissionStayTime = <span class="dig">0</span>
<span class="cmt">#if reach maximun time, change imagesOffset to imagesOffset_endMission</span>
imagesOffset_endMission = []


nEnterMissionTime = time.time()





<span class="kw">def</span> refreshSetting():
    Debug.user(<span class="str">'refresh setting, enumType= %d'</span> % enumType)
    <span class="kw">global</span> imageMissions
    <span class="kw">global</span>  bMoveOnceInMission
    <span class="kw">global</span>  bFindTargetInMission
    <span class="cmt"># 試煉/積分 True, 原石 False</span>
    <span class="kw">global</span>  bNeedAgree
    <span class="kw">global</span>  imageMonster
    <span class="cmt"># 寶石任務 False</span>
    <span class="kw">global</span>  bNeedOpenGift
    <span class="kw">global</span>  bUseGPS
    <span class="kw">global</span> imageBonus1
    <span class="kw">global</span> imageBonus2
    <span class="kw">global</span> autoKills


    <span class="cmt"># 先找Boss的圖</span>
    <span class="kw">global</span> bMoveToBoss
    <span class="kw">global</span> imageBoss

    <span class="kw">global</span> bFindMonsterBySelf
    <span class="kw">global</span> imageMonsters
    <span class="kw">global</span> bMoveToFighting
    <span class="kw">global</span> monsterRegion
    <span class="kw">global</span> bNeedUseOtherBranchServer
    <span class="kw">global</span> bMoveALittleAfterFight
    <span class="kw">global</span> autoKills
    <span class="kw">global</span> bMoveOnceInMission
    <span class="kw">global</span> locationFixedMoveInMission
    <span class="kw">global</span> bMoveTwiceInMission
    <span class="kw">global</span> locationFixedMoveInMission2
    <span class="kw">global</span> bUseGPS
    <span class="kw">global</span> nDelayBeforeUsingSkill
    <span class="kw">global</span> bNeedTransfer
    <span class="kw">global</span> bNeedToEnterEvpRoom
    <span class="kw">global</span> imagesOffset
    <span class="kw">global</span> imagesOffset_endMission
    <span class="kw">global</span> nMaximunMissionStayTime
    <span class="kw">global</span> enumType
    <span class="kw">global</span> bNeedSayThanks
    <span class="kw">global</span> monsterPositions
    <span class="kw">global</span> bNeedSkip
    <span class="kw">global</span> nMoveDelay
    <span class="kw">global</span> moveToFightingSteps
    <span class="kw">global</span> bNeedToBox
    bNeedSayThanks = False

    <span class="kw">if</span> enumType==enumPractice:
        <span class="cmt">#autoKills = [0,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4]  #土單 (霸劍</span>
        <span class="cmt"># True   False</span>
        <span class="cmt">#only move once</span>
        bMoveOnceInMission = False
        locationFixedMoveInMission = Location(<span class="dig">278</span>, <span class="dig">400</span>)
        bFindTargetInMission = False
        <span class="cmt"># 試煉/積分 True, 原石 False</span>
        bNeedAgree = True
        imageMonster = darkMonster
        <span class="cmt"># 寶石任務 False</span>
        bNeedOpenGift = True
        bUseGPS = True
        imageBonus1 = imageDropIncrease
        imageBonus2 = imageSpecialMonsterIncrease
        <span class="cmt">#autoKills = [1,2,3,4,5]  #12345</span>
        bNeedSayThanks = True
    <span class="kw">elif</span> enumType==enumStoneMission:
        bFindMonsterBySelf = True
        imagesOffset = [
                ImageOffset( <img src="1512648310904.png" />, <span class="dig">0</span>, <span class="dig">190</span>),
                ImageOffset( <img src="1512648362171.png" />, <span class="dig">0</span>, -<span class="dig">230</span>),
                ImageOffset( <img src="1515212634098.png" />, <span class="dig">40</span>, <span class="dig">220</span>),
                ImageOffset( <img src="1515329896146.png" />, <span class="dig">200</span>, <span class="dig">15</span>),
        ]
        bMoveToFighting = False
        monsterRegion = Region(<span class="dig">0</span>,<span class="dig">89</span>,<span class="dig">560</span>,<span class="dig">860</span>)
        <span class="cmt">#monsterRegion = monsterRegion_Up</span>
        bNeedUseOtherBranchServer = False
        bNeedSkip = False
        bSkipBeforeAgain = False
        <span class="cmt">#autoKills = [0,1,2,3,4,5,-1]</span>
        <span class="cmt">#autoKills = [5,5,1,3,0,2,0,2,4,]</span>
        <span class="cmt">#autoKills = [3, 1, 0, 2, -3, 4, -9, 5, -9]  #坦</span>
        <span class="cmt">#autoKills = [1,0,2,3,5,1,3,-1,4,0,2,1,3,-1,4]  #土單 (無霸劍</span>
        <span class="cmt">#autoKills = [0,1,2,3,5,4, 0,4,1,3,5,2,4,0,3,1,5,4,2,3,0,4]  #光evp</span>
        <span class="cmt">#autoKills = [0,1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4]  #土單 </span>
        <span class="cmt">#autoKills = [0,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4]  #土單 (霸劍</span>
        <span class="cmt">#autoKills = [1,2,0,0]   #範圍PK</span>
        <span class="cmt">#autoKills = [1,0,2,3,4,2,3,4] #單體PK</span>
        <span class="cmt">#autoKills = [0,2,5,1,4,2,3,4,1,4,2,3,4,1,4]</span>
        <span class="cmt">#autoKills = [0,1,2,3,4,5,3,4,-1,3,4,1,2,3,4,5,3,4,1,2,3,4,5,3,4]  #靈刀 </span>
        bMoveOnceInMission = False
        <span class="cmt">#locationFixedMoveInMission = Location(357, 464)</span>
        <span class="cmt">#locationFixedMoveInMission = Location(205, 520)</span>
        locationFixedMoveInMission = Location(<span class="dig">414</span>, <span class="dig">449</span>)   <span class="cmt"># godness</span>
        bMoveTwiceInMission = False
        <span class="cmt">#locationFixedMoveInMission2 = Location(355, 742)</span>
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        <span class="cmt">#monsterRegion = monsterRegion_Small</span>
        bNeedTransfer = False
        bMoveALittleAfterFight = True
        bUseGPS = False
        imageBonus1 = imageDropIncrease
        imageBonus2 = imageDoubleExp
        bNeedSayThanks = False
    <span class="kw">elif</span> enumType==enumFixLocation:
        bNeedUseOtherBranchServer = False
        <span class="cmt"># True   False</span>
        bMoveToFighting = False
        <span class="cmt">#only move once</span>
        bMoveOnceInMission = True
        bFindTargetInMission = False
        <span class="cmt"># 試煉/積分 True, 原石 False  </span>
        bNeedAgree = True
        <span class="cmt"># 寶石任務 False </span>
        bNeedOpenGift = True
        <span class="cmt"># click skip before mission </span>
        bNeedSkip = True
        <span class="cmt"># click skip after mission    </span>
        bSkipBeforeAgain = True
    <span class="kw">elif</span> enumType==enumFixLocationTwice:
        bNeedUseOtherBranchServer = True
        <span class="cmt"># True   False</span>
        <span class="cmt">#only move once</span>
        bMoveOnceInMission = True
        bMoveTwiceInMission = True
        bFindTargetInMission = False
        <span class="cmt"># 試煉/積分 True, 原石 False </span>
        <span class="cmt">#bNeedAgree = True </span>
        <span class="cmt"># 寶石任務 False </span>
        bNeedOpenGift = True
        <span class="cmt"># click skip before mission  </span>
        bNeedSkip = False
        <span class="cmt"># click skip after mission </span>
        bSkipBeforeAgain = True
        bMoveToFighting = True
    <span class="kw">elif</span> enumType==enumFixLocationDropExp:
        <span class="cmt"># True   False </span>
        bUseGPS = True
        imageBonus1 = imageDropIncrease
        imageBonus2 = imageDoubleExp
        <span class="cmt">#only move once</span>
        bMoveOnceInMission = True
        bFindTargetInMission = False
        bMoveToFighting = True
        <span class="cmt"># 試煉/積分 True, 原石 False</span>
        bNeedAgree = True
        <span class="cmt"># 寶石任務 False </span>
        bNeedOpenGift = True
        <span class="cmt"># click skip before mission</span>
        bNeedSkip = False
        <span class="cmt"># click skip after mission</span>
        bSkipBeforeAgain = False
    <span class="kw">elif</span> enumType==enumFixLocationSkip:
        monsterRegion = monsterRegion_Left
        bMoveOnceInMission = True
        bNeedAgree = True
        <span class="cmt"># 寶石任務 False</span>
        <span class="cmt">#bNeedOpenGift = True </span>
        <span class="cmt">#bNeedSkip = True</span>
        bSkipBeforeAgain = False
    <span class="kw">elif</span> enumType==enumFixLocationOtherServer:
        <span class="cmt">#only move once</span>
        bMoveOnceInMission = True
        bFindTargetInMission = False
        <span class="cmt"># 試煉/積分 True, 原石 False</span>
        bNeedAgree = True
        <span class="cmt"># 寶石任務 False </span>
        bNeedOpenGift = True
        <span class="cmt"># click skip before mission</span>
        bNeedSkip = False
        <span class="cmt"># click skip after mission</span>
        bSkipBeforeAgain = False
        bNeedUseOtherBranchServer = True
        <span class="cmt"># let second character fly to join</span>
        bSecondCharacterFlyToJoin = False
    <span class="kw">elif</span> enumType==enumMoveThanFind:
        <span class="cmt">#imageMissions = [ imageMissionTabs1[1], imageMissionTabs2[1], "1518973312540.png", "1518973338770.png",  Location(463, 243)  ]</span>
        <span class="cmt">#only move once</span>
        bMoveOnceInMission = True
        <span class="cmt">#locationFixedMoveInMission = imageMissions[4]</span>
        bFindTargetInMission = False
        monsterRegion = monsterRegion_Normal
        <span class="cmt">#bMoveALittleAfterFight = True</span>

        <span class="cmt"># 試煉/積分 True, 原石 False</span>
        bNeedAgree = False
        imageBonus1 = imageSpecialMonsterIncrease
        imageBonus2 = imageDropIncrease


    <span class="kw">elif</span> enumType== enumMoveThanFindSmall:
        <span class="cmt"># True   False</span>
        <span class="cmt">#only move once</span>
        bMoveOnceInMission = True
        <span class="cmt">#locationFixedMoveInMission = Location(267, 628)</span>
        bFindTargetInMission = False
        monsterRegion = monsterRegion_Small
        bMoveALittleAfterFight = True
        <span class="cmt"># 試煉/積分 True, 原石 False</span>
        bNeedAgree = False
        imageBonus1 = imageSpecialMonsterIncrease
        imageBonus2 = imageDropIncrease
        <span class="cmt">#monsterRegion = monsterRegion_Left </span>
    <span class="kw">elif</span> enumType==enumIronMonster:
        <span class="cmt"># True   False</span>
        <span class="cmt">#only move once</span>
        bMoveOnceInMission = True
        locationFixedMoveInMission = locationIronMonster
        bFindTargetInMission = False
        <span class="cmt"># 試煉/積分 True, 原石 False</span>
        bNeedAgree = True
        <span class="cmt"># 寶石任務 False</span>
        bNeedOpenGift = True
        imageMonster = ironMonster
        bUseGPS = False
        imageBonus1 = imageDoubleExp
        imageBonus2 = imageDropIncrease
    <span class="kw">elif</span> enumType==enumMoveALittle:
        <span class="cmt"># 自己找怪撞</span>
        bFindMonsterBySelf = False
        bMoveToFighting = False
        imageMonsters = [ <img src="1500760227483.png" />, <img src="1500760266200.png" /> ]
        bNeedUseOtherBranchServer = False
        bMoveToFighting = False
        bMoveALittleAfterFight = True
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        <span class="cmt">#monsterRegion = Region(166,391,229,191)</span>
        <span class="cmt"># let second character fly to join</span>
        <span class="cmt">#bSecondCharacterFlyToJoin = True</span>
        <span class="cmt">#bSkipBeforeAgain = True</span>
    <span class="kw">elif</span> enumType == enumMoveALittleAndFindFighting:
        bMoveOnceInMission = False
        locationFixedMoveInMission = Location(<span class="dig">321</span>, <span class="dig">264</span>)
        <span class="cmt"># 自己找怪撞</span>
        bFindMonsterBySelf = False
        bMoveToFighting = True
        bNeedUseOtherBranchServer = False
        bMoveALittleAfterFight = True
        monsterRegion = monsterRegion_Full
        imageBonus1 = imageDoubleExp
        imageBonus2 = imageDropIncrease
        <span class="cmt">#autoKills = [5,1,2,3,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,]</span>
    <span class="kw">elif</span> enumType==enumAudoFindMonster:
        bMoveOnceInMission = True
        locationFixedMoveInMission = Location(<span class="dig">12</span>, <span class="dig">193</span>)
        bMoveTwiceInMission = False
        locationFixedMoveInMission2 = Location(<span class="dig">551</span>, <span class="dig">477</span>)
        bMoveALittleAfterFight = False

        <span class="cmt"># 自己找怪撞</span>
        bFindMonsterBySelf = True
        bMoveToFighting = False
        imageMonsters = [ <img src="1512041728979.png" />,<img src="1512041737652.png" />                                              ]
        bNeedUseOtherBranchServer = True

        monsterRegion = monsterRegion_Full
        <span class="cmt"># let second character fly to join</span>
        <span class="cmt">#bSecondCharacterFlyToJoin = True</span>
        bNeedSkip = True
        autoKills = [<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">0</span>]
        bNeedUseOtherBranchServer = False
        bMoveALittleAfterFight = True
    <span class="kw">elif</span> enumType==enumEVP:
        imageMissions = [ imageMissionTabs1[<span class="dig">0</span>], imageMissionTabs2[<span class="dig">1</span>], <img src="1518710091699.png" />, <img src="1518710103021.png" />,
                Location(<span class="dig">419</span>, <span class="dig">470</span>)  ]
        bNeedToEnterEvpRoom = False

        bFindMonsterBySelf = False
        imageMonsters = [  ]
        moveToFightingSteps = Images( [ Pattern(<img src="imageOtherFighting2.png" />).similar(<span class="dig">0.90</span>).targetOffset(-<span class="dig">6</span>,<span class="dig">9</span>), Pattern(<img src="1515246341319.png" />).targetOffset(<span class="dig">0</span>,<span class="dig">5</span>), Pattern(<img src="1515825263702.png" />).similar(<span class="dig">0.80</span>).targetOffset(<span class="dig">8</span>,<span class="dig">5</span>), Pattern(<img src="1515939291635.png" />).similar(<span class="dig">0.90</span>).targetOffset(-<span class="dig">10</span>,<span class="dig">7</span>), Pattern(<img src="1516377416248.png" />).similar(<span class="dig">0.90</span>).targetOffset(-<span class="dig">11</span>,<span class="dig">8</span>), Pattern(<img src="1516502416160.png" />).targetOffset(-<span class="dig">18</span>,<span class="dig">7</span>), Pattern(<img src="1517135420431.png" />).targetOffset(<span class="dig">18</span>,<span class="dig">8</span>), Pattern(<img src="1518224309288.png" />).targetOffset(-<span class="dig">10</span>,-<span class="dig">26</span>), Pattern(<img src="1518224332972.png" />).targetOffset(-<span class="dig">8</span>,-<span class="dig">19</span>)] )
        imagesOffset = [
                RegionImageOffset(Region(<span class="dig">429</span>,<span class="dig">387</span>,<span class="dig">74</span>,<span class="dig">76</span>), Pattern(<img src="1518101646870.png" />).similar(<span class="dig">0.80</span>), <span class="dig">0</span>, <span class="dig">0</span>),
                RegionImageOffset(Region(<span class="dig">179</span>,<span class="dig">679</span>,<span class="dig">181</span>,<span class="dig">138</span>), <img src="1518178370741.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                <span class="cmt">#ImageOffset("1515431713946.png", -3, -10),  </span>
                <span class="cmt">#ImageOffset("1515431741504.png", 0, 0), </span>
                ImageOffset(Pattern(<img src="1518101646870.png" />).similar(<span class="dig">0.80</span>), <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(Pattern(<img src="1515431741504.png" />).similar(<span class="dig">0.61</span>), <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1518104379326.png" />, <span class="dig">300</span>,<span class="dig">100</span>),
                ImageOffset(<img src="1518104300615.png" />, -<span class="dig">100</span>,-<span class="dig">200</span>),
                ImageOffset(<img src="1518104042832.png" />, -<span class="dig">600</span>,-<span class="dig">100</span>),
                ImageOffset(<img src="1518101761747.png" />, <span class="dig">200</span>, -<span class="dig">20</span>)
                ]
        <span class="cmt"># maximun time to stay in a mission</span>
        nMaximunMissionStayTime = <span class="dig">60</span>
        <span class="cmt">#if reach maximun time, change imagesOffset to imagesOffset_endMission</span>
        imagesOffset_endMission = [
                ImageOffset(<img src="1515456372044.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515456342067.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515456410781.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515456424941.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515456446359.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515455039689.png" />, <span class="dig">263</span>, -<span class="dig">32</span>),
                ImageOffset(<img src="1515455198724.png" />, <span class="dig">71</span>, -<span class="dig">7</span>),

                ]


        bMoveToFighting = True
        <span class="cmt">#monsterRegion = Region(192,425,165,172)</span>
        <span class="cmt">#monsterRegion = monsterRegion_Small</span>
        monsterRegion = monsterRegion_Full
        bNeedUseOtherBranchServer = False
        bNeedSkip = True
        bSkipBeforeAgain = False
        <span class="cmt">#autoKills = [0,1,2,3,4,5]</span>
        <span class="cmt">#autoKills = [5,5,1,3,0,2,0,2,4,]</span>
        <span class="cmt">#autoKills = [4, 0, 1, -3, 3, 2, -2]  #坦 (2戰慄, 2復活)</span>
        <span class="cmt">#autoKills = [4, 0, 1, -2, 3, 2, -2, 4, 0, 1, -2, 3, 2, 5]  #坦 (2戰慄, 2復活, 6武)</span>
        <span class="cmt">#autoKills = [1,0,2,3,5,1,3,-1,4,0,2,1,3,-1,4]  #土單 (無霸劍</span>
        <span class="cmt">#autoKills = [0,1,2,3,5,4, 0,4,1,3,5,2,4,0,3,1,5,4,2,3,0,4]  #光evp</span>
        <span class="cmt">#autoKills = [0,1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4]  #土單 </span>
        <span class="cmt">#靈刀 </span>
        autoKills = [<span class="dig">5</span>,<span class="dig">0</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,-<span class="dig">1</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">3</span>,<span class="dig">4</span>]
        <span class="cmt">#autoKills = [1,4,3,2,5,0,2]  #火範圍</span>
        <span class="cmt">#autoKills = [5,0, 1, -2, 2, -2, 3, -2, 4] #補坦</span>
        bMoveOnceInMission = True
        <span class="cmt">#locationFixedMoveInMission = Location(243, 449) #螃蟹</span>
        <span class="cmt">#locationFixedMoveInMission = Location(347, 400) #章魚</span>
        <span class="cmt">#locationFixedMoveInMission = Location(383, 324) #龜</span>
        <span class="cmt">#locationFixedMoveInMission = Location(298, 267)  #蜂</span>
        <span class="cmt">#locationFixedMoveInMission = Location(184, 526) #土巨人</span>
        locationFixedMoveInMission = imageMissions[<span class="dig">4</span>]
        bMoveTwiceInMission = False
        locationFixedMoveInMission2 = Location(<span class="dig">355</span>, <span class="dig">742</span>)
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        <span class="cmt">#monsterRegion = monsterRegion_Small</span>
        bNeedTransfer = False
        bMoveALittleAfterFight = False
        bUseGPS =False
        imageBonus1 = imageDropIncrease
        imageBonus2 = imageDoubleExp
        bNeedSayThanks = False
        <span class="cmt">#nMoveDelay = 1</span>
    <span class="kw">elif</span> enumType==enumEVP_branch:
        imageMissions = imageEvpEventWind
        bNeedToEnterEvpRoom = True

        bFindMonsterBySelf = False
        imageMonsters = [  ]
        imagesOffset = [
                ImageOffset(<img src="1516665213764.png" />, <span class="dig">240</span>,-<span class="dig">15</span>),
                ImageOffset(<img src="1516665272701.png" />, <span class="dig">115</span>, <span class="dig">20</span>),
                ]
        bMoveToFighting = False
        <span class="cmt">#monsterRegion = monsterRegion_Normal</span>
        <span class="cmt">#monsterRegion = monsterRegion_Small</span>
        bNeedUseOtherBranchServer = True
        bMoveALittleAfterFight = False
        <span class="cmt"># let second character fly to join</span>
        bSecondCharacterFlyToJoin = False
        bNeedSkip = False
        bSkipBeforeAgain = False
        <span class="cmt">#autoKills = [0,1,2,3,4,5]</span>
        <span class="cmt">#autoKills = [2,3,1,5,0,2,4,2,2,3,3,1,2,3,1,4,4,5,1]  #坦</span>
        <span class="cmt">#autoKills = [3,1,2,5,0,3,4]  #光單</span>
        <span class="cmt">#autoKills = [1,2,5,0,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4]  #土單 血多一點</span>
        <span class="cmt">#autoKills = [0,1,5,4,-1,3,4,1,2,3,4,5,1,2,3,4,5,1,2,3,4,5,1,2,3,4,5,1,2,3,4,5]  #土單 血少的怪</span>
        <span class="cmt">#autoKills = [0,1,2,3,5,4, 0,4,1,3,5,2,4,0,3,1,5,4,2,3,0,4]  #光evp</span>
        <span class="cmt">#autoKills = [4,3,2,5,0,2,1]  #火範圍</span>
        <span class="cmt">#autoKills = [0,1,1,1,1,1,1,1,1,1,1]  #pvp 水靈刀</span>
        <span class="cmt">#靈刀 </span>
        <span class="cmt">#autoKills = [0,1,5,3,4,5,3,4,-1,3,4,1,2,3,4,3,4,1,2,3,4,5,3,4,1,2,3,4,3,4,3,4,1,2,3,4,5,3,4,1,2,3,4,3,4,1,2,3,4,5,3,4,3,4,1,2,3,4,5,3,4,1,2,3,4,3,4]  </span>
        <span class="cmt">#autoKills = [3,5,0,2,1]  #火範圍</span>

        bMoveOnceInMission = False
        <span class="cmt">#locationFixedMoveInMission = Location(450, 391)</span>
        bMoveTwiceInMission = False
        locationFixedMoveInMission2 = Location(<span class="dig">369</span>, <span class="dig">586</span>)
        bUseGPS =False
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        bNeedTransfer = False

    <span class="kw">elif</span> enumType==enumAutoSkill:
        <span class="cmt">#autoKills = [0,1,2,3,4,5]</span>
        <span class="cmt">#autoKills = [0,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4]  #土單 (霸劍</span>
        bCanEscap = False
        nCheckFightingTimes = <span class="dig">4</span>
    <span class="kw">elif</span> enumType==enumArmorAngle:
        imageMissions = imageArmorMission

        <span class="cmt"># 先找Boss的圖</span>
        bMoveToBoss = True
        imageBoss = [ <img src="1503320329329.png" />, <img src="1503964977321.png" />, <img src="1503965001575.png" />, <img src="1503965024324.png" /> ]
        <span class="cmt">#imageBoss = [ "1503320329329.png", "1502752920469.png" ]</span>

        bFindMonsterBySelf = True
        imageMonsters = [ ]

        imagesOffset = imagesOffset_angleArmor
        imageMonsters = []
        bMoveToFighting = False
        monsterRegion = monsterRegion_Full
        bNeedUseOtherBranchServer = True
        bMoveALittleAfterFight = False
        <span class="cmt">#autoKills = [0,1,2,3,4,5]  #12345</span>
        autoKills = [<span class="dig">0</span>,<span class="dig">1</span>,<span class="dig">5</span>,<span class="dig">4</span>,-<span class="dig">1</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>]  <span class="cmt">#土單 血少的怪</span>
        bMoveOnceInMission = False
        locationFixedMoveInMission = Location(<span class="dig">29</span>, <span class="dig">543</span>)
        bMoveTwiceInMission = False
        locationFixedMoveInMission2 = Location(<span class="dig">131</span>, <span class="dig">645</span>)
        bUseGPS =False
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        bNeedTransfer = True
    <span class="kw">elif</span> enumType==enumArmorWeekend:
        imageMissions =  [
            imageMissionTabs1[<span class="dig">1</span>],
            imageMissionTabs2[<span class="dig">1</span>],
            <img src="1506126880383.png" />, <img src="1506127026448.png" /> ]


        <span class="cmt"># 先找Boss的圖</span>
        bMoveToBoss = True
        <span class="cmt">#imageBoss = [ "1503320329329.png", "1503964977321.png", "1503965001575.png", "1503965024324.png" ]</span>
        imageBoss = [<img src="1503320329329.png" />, <img src="1506127773060.png" />]

        bFindMonsterBySelf = True
        <span class="cmt">#imageMonsters = [ "1504283821899.png", "1504283837684.png", "1504283849770.png" ]</span>
        imageMonsters = [<img src="1506127255039.png" />, <img src="1506127311313.png" />,<img src="1506127326969.png" />, <img src="1506127339509.png" />]

        <span class="cmt">#imagesOffset = imagesOffset_angleArmor</span>
        imagesOffset = []
        bMoveToFighting = False
        monsterRegion = monsterRegion_Full
        bNeedUseOtherBranchServer = True
        bMoveALittleAfterFight = True
        <span class="cmt">#autoKills = [1,5,2,3,4,2,3,4,2,3,4]  #12345</span>
        autoKills = [<span class="dig">0</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>]  <span class="cmt">#土單 (霸劍</span>
        bMoveOnceInMission = True
        locationFixedMoveInMission = Location(<span class="dig">448</span>, <span class="dig">531</span>)
        bMoveTwiceInMission = False
        locationFixedMoveInMission2 = Location(<span class="dig">131</span>, <span class="dig">645</span>)
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        bNeedTransfer = False
        bUseGPS =True
        imageBonus1 = imageSpecialMonsterIncrease
        imageBonus2 = imageDropIncrease
    <span class="kw">elif</span> enumType==enumArmorMele:
        imageMissions = imageArmorMission

        <span class="cmt"># 先找Boss的圖</span>
        bMoveToBoss = True
        imageBoss = [<img src="1503320329329.png" />, <img src="1506127773060.png" />]

        bFindMonsterBySelf = True
        imageMonsters = [<img src="1506127255039.png" />, <img src="1506127311313.png" />,<img src="1506127326969.png" />, <img src="1506127339509.png" />]

        imagesOffset = []
        bMoveToFighting = False
        monsterRegion = monsterRegion_Full
        bNeedUseOtherBranchServer = True
        bMoveALittleAfterFight = True
        <span class="cmt">#autoKills = [1,5,2,3,4,2,3,4,2,3,4]  #12345</span>
        autoKills = [<span class="dig">0</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>]  <span class="cmt">#土單 (霸劍</span>
        bMoveOnceInMission = True
        locationFixedMoveInMission = Location(<span class="dig">448</span>, <span class="dig">531</span>)
        bMoveTwiceInMission = False
        locationFixedMoveInMission2 = Location(<span class="dig">131</span>, <span class="dig">645</span>)
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        bNeedTransfer = True
        bUseGPS =False
        imageBonus1 = imageSpecialMonsterIncrease
        imageBonus2 = imageDropIncrease
    <span class="kw">elif</span> enumType==enumArmorAssassin:
        imageMissions = [ imageMissionTabs1[<span class="dig">1</span>], imageMissionTabs2[<span class="dig">0</span>], <img src="1519026030960.png" />, <img src="1519026047768.png" /> , Location(<span class="dig">459</span>, <span class="dig">252</span>) ]

        imageBoss = [ Pattern(<img src="1519036092542.png" />).similar(<span class="dig">0.90</span>) ]
        imageMonsters = [ Pattern(<img src="1519036092542.png" />).similar(<span class="dig">0.89</span>), Pattern(<img src="1519022763896.png" />).targetOffset(<span class="dig">57</span>,<span class="dig">17</span>)  ]

        imagesOffset = []

        <span class="cmt"># 先找Boss的圖</span>
        bMoveToBoss = True
        bFindMonsterBySelf = True
        bMoveToFighting = False
        monsterRegion = monsterRegion_Full
        bNeedUseOtherBranchServer = True
        bMoveALittleAfterFight = True
        <span class="cmt">#autoKills = [1,2,3,4,5]  #12345</span>
        autoKills = [<span class="dig">0</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">5</span>,-<span class="dig">1</span>,<span class="dig">4</span>]  <span class="cmt">#土單 (霸劍</span>
        bMoveOnceInMission = True
        locationFixedMoveInMission = imageMissions[<span class="dig">4</span>]
        bUseGPS =False
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        bNeedTransfer = False
    <span class="kw">elif</span> enumType==enumImageOffset:
        imageMissions = [ imageMissionTabs1[<span class="dig">1</span>], imageMissionTabs2[<span class="dig">1</span>], <img src="1519060295255.png" />, <img src="1519060311324.png" />, Location(<span class="dig">417</span>, <span class="dig">647</span>)  ]
        bFindMonsterBySelf = True
        bNeedToEnterEvpRoom = False
        imageBoss = [ Pattern(<img src="1519060392594.png" />).targetOffset(-<span class="dig">2</span>,<span class="dig">10</span>), Pattern(<img src="1519060419040.png" />).similar(<span class="dig">0.87</span>).targetOffset(<span class="dig">1</span>,<span class="dig">29</span>) ]
        bMoveToBoss = False
        imageMonsters = [ Pattern(<img src="1519099610872.png" />).targetOffset(-<span class="dig">102</span>,<span class="dig">34</span>) ] <span class="cmt">#, Pattern("1519060392594.png").targetOffset(-2,10), Pattern("1519060460368.png").targetOffset(106,11), Pattern("1519060955134.png").targetOffset(-65,40) ]</span>
        bMoveToFighting = False
        monsterRegion = Region(<span class="dig">0</span>,<span class="dig">89</span>,<span class="dig">560</span>,<span class="dig">860</span>)
        <span class="cmt">#monsterRegion = monsterRegion_Up</span>
        bNeedUseOtherBranchServer = True
        bNeedSkip = True
        bSkipBeforeAgain = False
        <span class="cmt">#autoKills = [0,1,2,3,4,5,-1]</span>
        <span class="cmt">#autoKills = [5,5,1,3,0,2,0,2,4,]</span>
        <span class="cmt">#autoKills = [3, 1, 0, 2, -3, 4, -9, 5, -9]  #坦</span>
        <span class="cmt">#autoKills = [1,0,2,3,5,1,3,-1,4,0,2,1,3,-1,4]  #土單 (無霸劍</span>
        <span class="cmt">#autoKills = [0,1,2,3,5,4, 0,4,1,3,5,2,4,0,3,1,5,4,2,3,0,4]  #光evp</span>
        <span class="cmt">#autoKills = [0,1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4]  #土單 </span>
        <span class="cmt">#autoKills = [0,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4,1,2,3,5,-1,4]  #土單 (霸劍</span>
        <span class="cmt">#autoKills = [1,2,0,0]   #範圍PK0</span>
        <span class="cmt">#autoKills = [1,0,2,3,4,2,3,4] #單體PK</span>
        <span class="cmt">#autoKills = [0,2,5,1,4,2,3,4,1,4,2,3,4,1,4]</span>
        autoKills = [<span class="dig">0</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,-<span class="dig">1</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">1</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">5</span>,<span class="dig">3</span>,<span class="dig">4</span>]  <span class="cmt">#靈刀 </span>
        <span class="cmt">#autoKills = [0,1,5,2,3,4]  #靈刀 (一輪爆發 </span>
        bMoveOnceInMission = False
        locationFixedMoveInMission = Location(<span class="dig">115</span>, <span class="dig">431</span>)
        <span class="cmt">#locationFixedMoveInMission = Location(205, 520)</span>
        bMoveTwiceInMission = False
        locationFixedMoveInMission2 = Location(<span class="dig">355</span>, <span class="dig">742</span>)
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        <span class="cmt">#monsterRegion = monsterRegion_Small</span>
        bNeedTransfer = False
        bMoveALittleAfterFight = True
        bUseGPS = False
        imageBonus1 = imageDropIncrease
        imageBonus2 = imageDoubleExp
        bNeedSayThanks = False
    <span class="kw">elif</span> enumType == enumArmorHand:
        <span class="kw">print</span> <span class="str">"enumArmorHand"</span>
        imageMissions = [ imageMissionTabs1[<span class="dig">1</span>], imageMissionTabs2[<span class="dig">0</span>], <img src="1518573553030.png" />,  <img src="1518912726571.png" />, Location(<span class="dig">413</span>, <span class="dig">499</span>)  ]
        bNeedToEnterEvpRoom = False

        bFindMonsterBySelf = False
        imageMonsters = [  ]
        imagesOffset = [
                ImageOffset(<img src="1517242962863.png" />, <span class="dig">500</span>, -<span class="dig">100</span>),
                ImageOffset(<img src="1518536903079.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1518538319407.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ]
        <span class="cmt"># maximun time to stay in a mission</span>
        nMaximunMissionStayTime = <span class="dig">60</span>
        <span class="cmt">#if reach maximun time, change imagesOffset to imagesOffset_endMission</span>
        imagesOffset_endMission = [
                ImageOffset(<img src="1515456372044.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515456342067.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515456410781.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515456424941.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515456446359.png" />, <span class="dig">0</span>, <span class="dig">0</span>),
                ImageOffset(<img src="1515455039689.png" />, <span class="dig">263</span>, -<span class="dig">32</span>),
                ImageOffset(<img src="1515455198724.png" />, <span class="dig">71</span>, -<span class="dig">7</span>),

                ]


        bMoveToFighting = False
        <span class="cmt">#monsterRegion = Region(69,407,385,248)</span>
        <span class="cmt">#monsterRegion = monsterRegion_Up</span>
        bNeedUseOtherBranchServer = True
        bNeedSkip = False
        bSkipBeforeAgain = False
        <span class="cmt">#autoKills = [0,1,2,3,4,5]</span>
        <span class="cmt">#autoKills = [5,5,1,3,0,2,0,2,4,]</span>
        <span class="cmt">#autoKills = [4, 0, 1, -5, 3, 2]  #坦 (2戰慄, 2復活)</span>
        <span class="cmt">#autoKills = [1,0,2,3,5,1,3,-1,4,0,2,1,3,-1,4]  #土單 (無霸劍</span>
        <span class="cmt">#autoKills = [0,1,2,3,5,4, 0,4,1,3,5,2,4,0,3,1,5,4,2,3,0,4]  #光evp</span>
        <span class="cmt">#autoKills = [0,1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4, 1,2,3,4,5, 1,2,3,4]  #土單 </span>
        <span class="cmt">#靈刀 </span>
        <span class="cmt">#autoKills = [0,1,2,3,4,5,3,4,-1,3,4,1,2,3,4,3,4,1,2,3,4,5,3,4,1,2,3,4,3,4,3,4,1,2,3,4,5,3,4,1,2,3,4,3,4,1,2,3,4,5,3,4,3,4,1,2,3,4,5,3,4,1,2,3,4,3,4]  </span>
        autoKills = [<span class="dig">3</span>,<span class="dig">0</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">1</span>] <span class="cmt">#銀河</span>
        bMoveOnceInMission = False
        <span class="cmt">#locationFixedMoveInMission = Location(243, 449) #螃蟹</span>
        locationFixedMoveInMission = Location(<span class="dig">347</span>, <span class="dig">399</span>) <span class="cmt">#章魚</span>
        <span class="cmt">#locationFixedMoveInMission = Location(383, 324) #龜</span>
        <span class="cmt">#locationFixedMoveInMission = Location(184, 526) #土巨人</span>
        <span class="cmt">#locationFixedMoveInMission = Location(205, 520)</span>
        bMoveTwiceInMission = False
        locationFixedMoveInMission2 = Location(<span class="dig">355</span>, <span class="dig">742</span>)
        nDelayBeforeUsingSkill = <span class="dig">0</span>
        <span class="cmt">#monsterRegion = monsterRegion_Small</span>
        bNeedTransfer = False
        bMoveALittleAfterFight = True
        bUseGPS =False
        imageBonus1 = imageDropIncrease
        imageBonus2 = imageDoubleExp
        bNeedSayThanks = False
        nMoveDelay = <span class="dig">1</span>
        bNeedToBox = True
    <span class="kw">else</span>:
        Debug.user(<span class="str">"error: unknown type"</span>);
    <span class="cmt">#Debug.user("mission image length=%d" % len(imageMissions))</span>



<span class="kw">def</span> checkMissionTimeOut():
    <span class="kw">global</span> imagesOffset
    <span class="kw">global</span> nMissionStartTime
    <span class="kw">global</span> nEnterMissionTime
    <span class="kw">global</span> nMaximunMissionStayTime

    <span class="kw">if</span> nMaximunMissionStayTime &gt; <span class="dig">0</span> <span class="kw">and</span> nMaximunMissionStayTime &lt; time.time() - nEnterMissionTime:
        Debug.user(<span class="str">"Change imagesOffset to imagesOffset_endMission"</span>)
        imagesOffset = imagesOffset_endMission
        Debug.user(<span class="str">"checkMissionTimeOut, in mission time=%d"</span> % (time.time() - nEnterMissionTime))

<span class="cmt"># ============================</span>



<span class="kw">def</span> main():
    <span class="kw">global</span> enumType
    <span class="kw">global</span> nEnterMissionTime
    <span class="kw">global</span> bLogingIn
    isTransfered = False
    isMoved = False
    bLeavingFighting = False

    <span class="kw">while</span> True:
        <span class="kw">if</span> bNeedSkip:
            d(<span class="str">"skip"</span>, <img src="1500213106784.png" />, <span class="dig">2</span>)

        <span class="kw">if</span> waitFightingFinished():
            Debug.user(<span class="str">"bLeavingFighting = True"</span>)
            isMoved = True
            bLeavingFighting = True
        Debug.user(<span class="str">"bLeavingFighting = %d"</span> % bLeavingFighting)

        <span class="cmt"># check current page</span>
        enumPageId = getPageId()
        Debug.user(<span class="str">"enumPageId = %d"</span> % enumPageId)

        <span class="kw">if</span> enumPageId == PageId.enumPageId_mission:

            <span class="kw">if</span> bLeavingFighting:
                checkMissionTimeOut()
                bLeavingFighting = False
                <span class="kw">if</span> bMoveALittleAfterFight:
                    moveALitte()
                    <span class="kw">continue</span>

            <span class="kw">if</span> <span class="kw">not</span> isMoved:
                nEnterMissionTime = time.time()
                refreshSetting()
                <span class="kw">if</span> bMoveOnceInMission:
                    isMoved = True
                    l(<span class="str">"locationFixedMoveInMission"</span>, locationFixedMoveInMission )
                    <span class="skw">sleep</span>(nMoveDelay)
                <span class="kw">if</span> bMoveTwiceInMission:
                    isMoved = True
                    l(<span class="str">"locationFixedMoveInMission2"</span>, locationFixedMoveInMission2 )
                    <span class="skw">sleep</span>(nMoveDelay2)
                <span class="kw">if</span> bLogingIn:
                    zoomout()
                    bLogingIn = False

            <span class="kw">if</span> bFindTargetInMission:
                c(<img src="1499951382722.png" />, <span class="dig">0</span>)
                <span class="skw">sleep</span>(<span class="dig">3</span>)
            moveToTaskTargetOnce()
            waitFighting(<span class="dig">2</span>)
        <span class="kw">elif</span> enumPageId == PageId.enumPageId_fighting:
            <span class="cmt"># still fighting</span>
            Debug.user(<span class="str">"still fighting"</span>)
        <span class="kw">elif</span> enumPageId == PageId.enumPageId_board:
            enterMission()
            bLeavingFighting = False
        <span class="kw">elif</span> enumPageId == PageId.enumPageId_skip:
            d(<span class="str">"skip"</span>, <img src="1500213106784.png" />, <span class="dig">2</span>)
        <span class="kw">elif</span> (enumPageId == PageId.enumPageId_again) | (enumPageId == PageId.enumPageId_openGift):
            isMoved = False
            <span class="kw">if</span> bSkipBeforeAgain:
                d(<span class="str">"skip"</span>, <img src="1500213106784.png" />, <span class="dig">2</span>)

            <span class="cmt">#repeat mission</span>
            enterAgain()
            bLeavingFighting = False

            <span class="cmt">#if bNeedSkip:</span>
            <span class="cmt">#    d("skip", "1500213106784.png", 2)</span>
            <span class="cmt">#    sleep(2)</span>
        <span class="kw">elif</span> enumPageId == PageId.enumPageId_close:
            d(<span class="str">"close some page"</span>, imageClose, <span class="dig">0</span>)
        <span class="kw">elif</span> enumPageId == PageId.enumPageId_missionClosed:
            <span class="cmt"># mission closed, go to next mission</span>
            l(<span class="str">"click once"</span>, Location(<span class="dig">266</span>, <span class="dig">505</span>))
            enumType = enumTypeNext
            refreshSetting()
        <span class="kw">elif</span> enumPageId == PageId.enumPageId_login:
            loginGame()
        <span class="kw">else</span>: <span class="cmt">#unknown</span>
           <span class="skw">sleep</span>(<span class="dig">0.1</span>)

    <span class="cmt">#waitMissionStarted()</span>
    <span class="cmt">#click( locationFixedMoveInMission )</span>

<span class="kw">def</span> enterAgain():
    <span class="kw">global</span> g_bEnterBoxOnce
    g_bEnterBoxOnce = False

    d( <span class="str">"imageAgain"</span>, imageAgain, <span class="dig">2</span> )
    <span class="skw">sleep</span>(<span class="dig">3</span>)

    <span class="cmt">#click all next page</span>
    i = <span class="dig">0</span>
    retry = <span class="dig">0</span>
    <span class="kw">while</span> True:
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="kw">if</span> gameRegion.exists( <img src="1503187522791.png" />, <span class="dig">0</span>):
            d( <span class="str">"imageAgree"</span>, imageAgree, <span class="dig">0</span> )
            <span class="kw">continue</span>
        <span class="kw">if</span> gameRegion.exists( <img src="1503186459432.png" />, <span class="dig">0</span>):
            d( <span class="str">"imageOpenGift"</span>, imageOpenGift, <span class="dig">0</span> )

        <span class="kw">if</span> gameRegion.exists(imageGo, <span class="dig">0</span>):
            <span class="kw">break</span>
        <span class="kw">if</span> gameRegion.exists(<img src="1503200826656.png" />, <span class="dig">0</span>):
            d(<span class="str">"click again"</span>, <img src="1503200826656.png" />, <span class="dig">0</span>)
            <span class="kw">continue</span>

        i = i + <span class="dig">1</span>
        <span class="kw">if</span> d( <span class="str">"imageNextPage "</span> + str(i) , imageNextPage1, <span class="dig">1</span> ):
            retry = <span class="dig">0</span>
        <span class="kw">if</span> d( <span class="str">"imageNextPage3"</span> , imageNextPage3, <span class="dig">0</span> ):
            retry = <span class="dig">0</span>
        retry = retry + <span class="dig">1</span>
        <span class="kw">if</span> retry &gt;= <span class="dig">5</span>:
            <span class="kw">break</span>;
        <span class="kw">if</span> i &gt; <span class="dig">10</span>:  <span class="cmt">#任務全部完成時, 比較久</span>
            <span class="kw">break</span>;

<span class="cmt">#    d( "imageNextPage3", imageNextPage1, 1 )</span>
<span class="cmt">#    d( "imageOpenGift", imageOpenGift, 2 )</span>
    <span class="cmt">#if bNeedOpenGift:</span>
    <span class="cmt">#    d( "imageOpenGift", imageOpenGift, 2 )</span>
    <span class="cmt">#d( "imageAgain2", imageAgain2, 1 )</span>
    <span class="cmt">#d( "imageNextPage2", imageNextPage2, 3 )</span>
    <span class="cmt">#if bNeedAgree:</span>
    <span class="cmt">#    sleep(1)</span>
    <span class="cmt">#    d( "imageAgree", imageAgree, 3 )</span>
    <span class="kw">if</span> bUseGPS:
        useGPS()
    <span class="kw">elif</span> bNeedUseOtherBranchServer:
        changeBranchServer()
    <span class="kw">else</span>:
        d( <span class="str">"imageGo"</span>, imageGo, <span class="dig">2</span> )

    Debug.user(<span class="str">"bNeedSkip=%d"</span> % bNeedSkip)
    <span class="kw">if</span> bNeedSkip:
        d(<span class="str">"skip"</span>, <img src="1500213106784.png" />, <span class="dig">10</span>)

    <span class="kw">if</span> <span class="kw">not</span> waitMissionStarted(<span class="dig">10</span>):
        Debug.user(<span class="str">"warning: haven't entered again"</span>)
        enterMission()
    <span class="kw">if</span> bNeedTransfer:
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        transfer()

<span class="cmt">#***********************************************************************</span>





<span class="kw">def</span> clickMonster():
    backupDelay = Settings.MoveMouseDelay
    Settings.MoveMouseDelay = <span class="dig">0.02</span>
    <span class="kw">for</span> p <span class="kw">in</span> monsterPositions:
        <span class="kw">if</span> isFighting():
            <span class="skw">click</span>(p)
        <span class="kw">else</span>:
            <span class="kw">break</span>
    Settings.MoveMouseDelay = backupDelay











<span class="kw">def</span> changeBranchServer():
    <span class="kw">if</span> <span class="kw">not</span> d(<span class="str">"branch servet button"</span>,<img src="1499732606430.png" />):
        <span class="kw">return</span> False

    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="cmt">#click(Location(272, 321)) </span>
    <span class="cmt">#click(Location(273, 701))  #6th server</span>
    <span class="cmt">#return True</span>

    <span class="kw">if</span> <span class="kw">not</span> clickInRegion(Region(<span class="dig">38</span>,<span class="dig">570</span>,<span class="dig">475</span>,<span class="dig">389</span>), <img src="1499732622006.png" />, <span class="dig">2</span>):
        <span class="kw">return</span> False
    <span class="kw">return</span> True
<span class="cmt">#    serversRegion = Region(80,312,389,505)</span>

<span class="cmt">#    servers = [] # an empty list</span>
<span class="cmt">#    for server in serversRegion.findAll("1499732622006.png"):</span>
<span class="cmt">#        servers.append(server)</span>

<span class="cmt">#    if len(server) &lt;= 0:</span>
<span class="cmt">#        Debug.user("error: can't find server")</span>
<span class="cmt">#        return False</span>

<span class="cmt">#    num = random.randrange( 0, len(servers) )</span>
<span class="cmt">#    Debug.user("find %d servers, use %d" % len(server) % num )</span>

<span class="cmt">#    l("click server", servers[num])</span>

<span class="cmt">#    return True</span>

<span class="cmt"># 關掉每天早上的公告</span>
<span class="kw">def</span> closeAnnouncement():
    <span class="kw">while</span> True :
        <span class="kw">if</span> <span class="kw">not</span> d(<span class="str">"close announcement"</span>, <img src="1500854126779.png" />, <span class="dig">0</span>):
            <span class="kw">break</span>
        <span class="skw">sleep</span>(<span class="dig">1</span>)

<span class="cmt"># 關掉每天早上的公告 (第2個視窗</span>
<span class="kw">def</span> closeAnnouncement2():
    <span class="kw">while</span> True :
        <span class="kw">if</span> <span class="kw">not</span> d2(<span class="str">"close announcement 2"</span>, <img src="1500854126779.png" />, <span class="dig">0</span>):
            <span class="kw">break</span>
        <span class="skw">sleep</span>(<span class="dig">2</span>)

<span class="kw">def</span> enterMission():
    Debug.user(<span class="str">"enterMission+"</span>)

    closeAnnouncement()

    d( <span class="str">"imageTaskBoard"</span>, imageTaskBoard, <span class="dig">10</span> )

    <span class="kw">if</span> <span class="kw">not</span> gameRegion.exists(<img src="1511573781918.png" />, <span class="dig">10</span>):
        <span class="kw">if</span> <span class="kw">not</span> gameRegion.exists(<img src="1515432205825.png" />, <span class="dig">10</span>):
            Debug.user(<span class="str">"error: did not enter mission select page."</span>)
            <span class="kw">return</span> False

    bFoundMission = False

    <span class="skw">sleep</span>(<span class="dig">4</span>)
    <span class="kw">if</span> isinstance(imageMissions, Images):
        Debug(<span class="str">"click imageMissions"</span>)
        <span class="kw">while</span> True:
            Debug.user(<span class="str">"click match images"</span>)
            imageMissions.clickMatch()

    nSteps= <span class="dig">4</span> <span class="cmt">#len(imageMissions)</span>
    Debug.user(<span class="str">"mission steps len=%d"</span> %nSteps)
    i = <span class="dig">0</span>

    swipTimes = <span class="dig">0</span>
    <span class="kw">while</span> i &lt; nSteps:
        Debug.user(<span class="str">"click mission %d"</span> % i)
        <span class="kw">if</span> <span class="kw">not</span> d( <span class="str">"select mission"</span>, imageMissions[i], <span class="dig">2</span>):
            bFoundMission = False
            Debug.user(<span class="str">"can't find mission %d"</span> % i)

            <span class="kw">if</span> i==<span class="dig">2</span>:
                swipUp()
                swipTimes = swipTimes+<span class="dig">1</span>
                <span class="kw">if</span> swipTimes &gt; <span class="dig">3</span>:
                    Debug.user(<span class="str">"error: can't find mission"</span>)
                    <span class="kw">return</span> False
                <span class="skw">sleep</span>(<span class="dig">2</span>)
                <span class="kw">continue</span>

            <span class="kw">if</span> d(<span class="str">"click back"</span>, <img src="1503880320458.png" />):
                i = i - <span class="dig">1</span>

        <span class="kw">else</span>:
            bFoundMission = True
            <span class="skw">sleep</span>(<span class="dig">0.5</span>)
        i = i+<span class="dig">1</span>

    <span class="kw">if</span> <span class="kw">not</span> bFoundMission:
        Debug.user(<span class="str">"not find mission"</span>)
        <span class="kw">return</span> False

    d(<span class="str">"select partner"</span>, Pattern(<img src="1507126890560.png" />).exact(), <span class="dig">5</span> )
    <span class="kw">while</span> d(<span class="str">"OK partner"</span>, Pattern(<img src="1507126862134.png" />).exact() ):
        <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="kw">if</span> bUseGPS:
        useGPS()
        d(<span class="str">"go"</span>, <img src="1498995593560.png" /> )
        <span class="kw">if</span> gameRegion.exists(<img src="1498267506267.png" />):
            d(<span class="str">"go"</span>, <img src="1498995593560.png" /> )
    <span class="kw">if</span> bNeedUseOtherBranchServer:
        <span class="kw">if</span> <span class="kw">not</span> changeBranchServer():
            d(<span class="str">"go"</span>, <img src="1498995593560.png" /> )
    <span class="kw">else</span>:
        d(<span class="str">"go"</span>,<img src="1498995593560.png" /> )

    d( <span class="str">"skip"</span>, <img src="1500716627071.png" />, <span class="dig">10</span> )
    <span class="cmt">#d( "skip", "1500716627071.png", 0 )</span>
    <span class="kw">if</span> <span class="kw">not</span> gameRegion.exists(imageFriendMenu, <span class="dig">30</span>):
        <span class="kw">return</span> False
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    closeAnnouncement()
    <span class="kw">if</span> bNeedTransfer:
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        transfer()
    <span class="kw">return</span> True

<span class="kw">def</span> swipUp():
    mouseMove(Location(<span class="dig">283</span>, <span class="dig">633</span>))
    mouseDown(Button.LEFT)
    mouseMove(Location(<span class="dig">284</span>, <span class="dig">282</span>))
    mouseUp(Button.LEFT)

<span class="kw">def</span> loginGame():
    <span class="kw">global</span> bLogingIn
    Debug.user(<span class="str">"login game"</span>)
    d(<span class="str">"close crasj"</span>, <img src="1517104193110.png" />)
    d(<span class="str">"launch game"</span>, <img src="1516981340816.png" />)
    <span class="kw">if</span> <span class="kw">not</span> d(<span class="str">"touch to start"</span>, <img src="1516981376522.png" />, <span class="dig">30</span>):
        <span class="kw">return</span> False
    <span class="kw">if</span> <span class="kw">not</span> d(<span class="str">"game start"</span>, <img src="1516981415557.png" />, <span class="dig">30</span>):
        <span class="kw">return</span> False
    <span class="kw">if</span> <span class="kw">not</span> gameRegion.exists(<img src="1516981563988.png" />, <span class="dig">60</span>):
        <span class="kw">return</span> False
    <span class="skw">sleep</span>(<span class="dig">3</span>)
    zoomout()
    bLogingIn = True
    <span class="kw">return</span> True

<span class="kw">def</span> zoomout():
    mouseMove(Location(<span class="dig">263</span>, <span class="dig">300</span>))
    mouseDown(Button.LEFT)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    i = <span class="dig">300</span>
    <span class="kw">while</span> i &lt;= <span class="dig">800</span>:
        i += <span class="dig">5</span>
        mouseMove(Location(<span class="dig">263</span>, i))
        <span class="skw">sleep</span>(<span class="dig">0.1</span>)
    mouseUp(Button.LEFT)
<span class="cmt">#zoomout()</span>

<span class="kw">def</span> zoomin():
    i = <span class="dig">800</span>
    mouseMove(Location(<span class="dig">263</span>, i))
    mouseDown(Button.LEFT)
    <span class="kw">while</span> i &gt; <span class="dig">300</span>:
        i -= <span class="dig">20</span>
        mouseMove(Location(<span class="dig">263</span>, i))
        <span class="skw">sleep</span>(<span class="dig">0.03</span>)
    mouseUp(Button.LEFT)


<span class="kw">def</span> isOnMission():
    reg = Region(<span class="dig">438</span>,<span class="dig">23</span>,<span class="dig">110</span>,<span class="dig">78</span>)
    <span class="kw">if</span> reg.exists(Pattern(<img src="1499210289316.png" />).similar(<span class="dig">0.80</span>), <span class="dig">0</span>):
        Debug.user(<span class="str">"isOnMission=True"</span>)
        <span class="kw">return</span> True
    <span class="kw">else</span>:
        Debug.user(<span class="str">"isOnMission=False"</span>)
        <span class="kw">return</span> False


<span class="kw">def</span> waitMissionStarted(retry = <span class="dig">10</span>):
    Debug.user(<span class="str">"waitMissionStarted+"</span>)
    i = <span class="dig">0</span>
    bInMission = False
    <span class="kw">for</span> n <span class="kw">in</span> range(retry):
        <span class="kw">if</span> isOnMission():
            <span class="kw">return</span> True
        <span class="skw">sleep</span>(<span class="dig">1</span>)
    Debug.user(<span class="str">"waitMissionStarted-"</span>)
    <span class="kw">return</span> False

<span class="cmt"># 有人喊 有BOSS, 台版比較好用, 日版太多人道謝</span>
<span class="kw">def</span> moveToBoss():
    Debug.user(<span class="str">"moveToBoss+"</span>)

    <span class="kw">try</span>:
        monster = monsterRegion.<span class="skw">find</span>()
        <span class="skw">click</span>(monster.offset(<span class="dig">0</span>, <span class="dig">80</span>))
        <span class="kw">return</span> True
    <span class="kw">except</span> FindFailed:
         <span class="kw">return</span> False




<span class="kw">def</span> moveToFighting():
    Debug.user(<span class="str">"moveToFighting+"</span>)
    moveToFightingSteps.setRoi(monsterRegion)
    target = moveToFightingSteps.getMatch()
    <span class="kw">if</span> target != None:
        gameRegion.<span class="skw">click</span>(target)
        center = gameRegion.getCenter()
        s = (abs(target.x-center.x) + abs(target.y-center.y)) * <span class="dig">0.01</span>
        Debug.user(<span class="str">"sleep %d"</span> % s)
        <span class="skw">sleep</span>( s )
        <span class="kw">return</span> True
    <span class="kw">else</span>:
        Debug.user(<span class="str">"can't find match"</span>)
        <span class="kw">return</span> False

<span class="kw">def</span> moveToFighting2():
    Debug.user(<span class="str">"moveToFighting2+"</span>)
    <span class="kw">try</span>:
        monster = monsterRegion.<span class="skw">find</span>(imageOtherFighting2)
        clickRegionBottom(monster)
        <span class="kw">return</span> True
    <span class="kw">except</span> FindFailed:
        <span class="kw">return</span> False


<span class="kw">def</span> moveToMonster(image):
    <span class="kw">try</span>:
        <span class="kw">if</span> <span class="kw">not</span> monsterRegion.exists(image, <span class="dig">0</span>):
            <span class="kw">return</span> False
        <span class="cmt">#monster = monsterRegion.find(image)</span>
        monsterRegion.<span class="skw">click</span>( monsterRegion.getLastMatch() )
        <span class="cmt">#clickRegionBottom(monster)</span>
        <span class="kw">return</span> True
    <span class="kw">except</span> FindFailed:
        <span class="kw">return</span> False
    <span class="kw">return</span> False

<span class="kw">def</span> moveToImageOffset( imageOffset ):
    <span class="kw">try</span>:
        targetRegion = monsterRegion
        <span class="kw">if</span> str(imageOffset.__class__) == <span class="str">"ControlLib.RegionImageOffset"</span>:
            targetRegion = imageOffset.region
            Debug.user(<span class="str">"target region = %s"</span>, targetRegion)


        <span class="kw">if</span> <span class="kw">not</span> targetRegion.exists(imageOffset.image, <span class="dig">0</span>):
            Debug.user(<span class="str">"not found on monsterRegion %s"</span> % monsterRegion)
            <span class="kw">return</span> False
        target = targetRegion.<span class="skw">find</span>(imageOffset.image)
        offsetX = imageOffset.offsetX
        offsetY = imageOffset.offsetY
        <span class="kw">if</span> offsetX + target.x &lt; <span class="dig">0</span>:
            <span class="cmt">#Debug.user("offsetX=%d, target.x=%d" % imageOffset.offsetX , target.x)</span>
            offsetX = -<span class="dig">1</span>*target.x
        <span class="kw">if</span> offsetY + target.y &lt; <span class="dig">0</span>:
            <span class="cmt">#Debug.user("offsetY=%d, target.y=%d" % imageOffset.offsetY , target.y)</span>
            offsetY = -<span class="dig">1</span>*target.y
        <span class="kw">if</span> offsetX + target.x &gt;= gameRegion.w:
            offsetX = <span class="dig">0</span>
            target.x = gameRegion.w
        <span class="kw">if</span> offsetY + target.y &gt;= gameRegion.h:
            offsetY = <span class="dig">0</span>
            target.y = gameRegion.h

        Debug.user(<span class="str">"offsetX = %d"</span> % offsetX)
        Debug.user(<span class="str">"target.x = %d"</span> % target.x)
        gameRegion.<span class="skw">click</span>( target.offset(offsetX, offsetY) )
        <span class="kw">return</span> True
    <span class="kw">except</span> FindFailed:
        <span class="kw">return</span> False
    <span class="kw">return</span> False

<span class="cmt"># 檢查是否在任務中, 是的話就移過去打怪</span>
<span class="kw">def</span> moveToTaskTargetOnce():
    Debug.user(<span class="str">"moveToTaskTargetOnce+"</span>)
    <span class="kw">while</span> (isOnMission() &amp; (<span class="kw">not</span> isFighting())):
        <span class="kw">if</span> bNeedToEnterEvpRoom:
            moveToEvpTarget()
            <span class="kw">break</span>

        <span class="kw">if</span> bNeedToBox:
            moveToBox()  <span class="cmt">#for hand mission</span>
            <span class="kw">break</span>

        <span class="kw">if</span> bBossMonsterFirst:
            <span class="kw">if</span> moveToBoss():
                <span class="skw">sleep</span>(<span class="dig">2</span>)
                <span class="kw">break</span>

        <span class="kw">if</span> bMoveToFighting:
            <span class="kw">if</span> moveToFighting():
                waitFightingFinished(<span class="dig">4</span>)
                <span class="kw">break</span>


        <span class="kw">if</span> bFindMonsterBySelf:
            i = <span class="dig">0</span>

            <span class="kw">if</span> len(imagesOffset)&gt;<span class="dig">0</span>:
                <span class="kw">for</span> imageOffset <span class="kw">in</span> imagesOffset:
                    i = i+<span class="dig">1</span>
                    Debug.user(<span class="str">"move to imageOffset %d"</span> % i)
                    <span class="kw">if</span> moveToImageOffset(imageOffset):
                        <span class="skw">sleep</span>(<span class="dig">2</span>)
                        <span class="kw">return</span> True
            <span class="kw">else</span>:
                <span class="kw">for</span> image <span class="kw">in</span> imageMonsters:
                    i = i+<span class="dig">1</span>
                    Debug.user(<span class="str">"moveToMonster %d"</span> % i)
                    <span class="kw">if</span> moveToMonster(image):
                        <span class="skw">sleep</span>(<span class="dig">2</span>)
                        <span class="kw">return</span> True


imageNextPage = <img src="1497762347177.png" />
imageOpenGift = <img src="1497756359246.png" />
friendMenu = <img src="1497755516858.png" />

<span class="kw">def</span> isFriendMenu():
    <span class="kw">if</span> Region(<span class="dig">313</span>,<span class="dig">25</span>,<span class="dig">90</span>,<span class="dig">76</span>).exists(friendMenu)!=None:
        Debug.user(<span class="str">"isFriendMenu=true"</span>)
    <span class="kw">else</span>:
        Debug.user(<span class="str">"isFriendMenu=false"</span>)

<span class="kw">def</span> finishMission():
    Debug.user(<span class="str">"finishMission+"</span>)

    <span class="kw">for</span> n <span class="kw">in</span> range(<span class="dig">2</span>):
        Debug.user(<span class="str">"wait next page"</span>)
        <span class="kw">if</span> <span class="kw">not</span> c(imageOpenGift):
            Debug.user(<span class="str">"can't find imageOpenGift button"</span>)
        <span class="kw">if</span> <span class="kw">not</span> c(imageNextPage):
            Debug.user(<span class="str">"can't find next page button"</span>)

    <span class="kw">return</span> True

<span class="kw">def</span> isFighting():
    <span class="kw">if</span> bCanEscap:
        <span class="kw">if</span> escapeRegion.exists(<img src="1497776017507-2.png" />, <span class="dig">0</span>):
            Debug.user(<span class="str">"isFighting=true"</span>)
            <span class="kw">return</span> True
    <span class="kw">if</span> escapeRegion.exists(<img src="1498270581243.png" />, <span class="dig">0</span>):
        Debug.user(<span class="str">"isFighting=true"</span>)
        <span class="kw">return</span> True
    Debug.user(<span class="str">"isFighting=false"</span>)
    <span class="kw">return</span> False

<span class="kw">def</span> waitFightingVanish( timeout = <span class="dig">0</span> ):
    <span class="kw">if</span> bCanEscap:
        <span class="kw">if</span> escapeRegion.waitVanish(<img src="1497776017507-2.png" />, timeout):
            Debug.user(<span class="str">"fighting vanish"</span>)
            <span class="kw">return</span> True
    <span class="kw">if</span> escapeRegion.waitVanish(<img src="1498270581243.png" />, <span class="dig">0</span>):
        Debug.user(<span class="str">"fighting vanish"</span>)
        <span class="kw">return</span> True
    Debug.user(<span class="str">"still isFighting"</span>)
    <span class="kw">return</span> False

<span class="kw">def</span> waitFighting( timeout ):
    Debug.user(<span class="str">"waitFighting+"</span>)
    <span class="kw">if</span> bCanEscap:
        <span class="kw">if</span> escapeRegion.exists(<img src="1497776017507-2.png" />, timeout):
            Debug.user(<span class="str">"isFighting=true"</span>)
            <span class="kw">return</span> True
    <span class="kw">if</span> escapeRegion.exists(<img src="1498270581243.png" />, timeout):
        Debug.user(<span class="str">"isFighting=true"</span>)
        <span class="kw">return</span> True
    Debug.user(<span class="str">"isFighting=false"</span>)
    <span class="kw">return</span> False

<span class="kw">def</span> waitFightingFinished( i = nCheckFightingTimes ):
    Debug.user(<span class="str">"waitFightingFinished+"</span>)
    i = <span class="dig">0</span>
    bFighting = False
    <span class="cmt"># is finished from fight</span>
    bFought = False
    bSaidThanks = False
    <span class="kw">while</span> True:
        <span class="kw">if</span> <span class="kw">not</span> isFighting():
            bFighting = False
            i = i - <span class="dig">1</span>
            <span class="kw">if</span> i &lt;= <span class="dig">0</span>:
                <span class="kw">break</span>
            <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="kw">else</span>:
            i = <span class="dig">0</span>
            <span class="kw">if</span> <span class="kw">not</span> bFighting:
                <span class="skw">sleep</span>(<span class="dig">1</span>)
                clickMonster()
                bFighting = True
            <span class="kw">else</span>:
                <span class="skw">sleep</span>(<span class="dig">1</span>)
                bFought = True


                <span class="kw">if</span> bNeedSayThanks &amp; (<span class="kw">not</span> bSaidThanks):
                    bSaidThanks = SayThanksIfRare()

                <span class="cmt">#if Region(398,80,154,71).exists("1502364055024.png", 2):</span>
                <span class="cmt">#    d("exit", "1502364132345.png")</span>
                <span class="cmt">#    d("exit2", "1502364152924.png",2)</span>
                autoUseSkill()
    Debug.user(<span class="str">"waitFightingFinished-"</span>)
    <span class="kw">return</span> bFought


imageSkillStandBy = <img src="imageSkillStandBy.png" />
regionSkillStandBy = Region(<span class="dig">1</span>,<span class="dig">560</span>,<span class="dig">551</span>,<span class="dig">384</span>)
<span class="cmt"># use a skill on specify position</span>
<span class="kw">def</span> useSkill( position ):
    <span class="skw">click</span>( position )
    <span class="kw">if</span> regionSkillStandBy.exists(imageSkillStandBy, <span class="dig">2</span>):
        Debug.user(<span class="str">"A skill is standby"</span>);
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        regionSkillStandBy.waitVanish(imageSkillStandBy, <span class="dig">30</span>)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="kw">return</span> True
    <span class="kw">else</span>:
        Debug.user(<span class="str">"can't find standby skill"</span>)
    <span class="kw">return</span> False

<span class="cmt">#戰鬥</span>
<span class="kw">def</span> autoUseSkill():
    bWaitFirstEp = True
    <span class="cmt">#判斷是否在戰鬥</span>
    <span class="kw">try</span>:
        reg = Region(<span class="dig">9</span>,<span class="dig">563</span>,<span class="dig">546</span>,<span class="dig">375</span>)

        Debug.user(<span class="str">"Use skill"</span>)
        <span class="kw">for</span> n <span class="kw">in</span> autoKills:
            <span class="kw">if</span> isFighting():
                questionMark = Pattern(<img src="1511531977194.png" />).similar(<span class="dig">0.97</span>)
                <span class="kw">if</span> reg.exists(questionMark,<span class="dig">0</span>):

                    firstSkill = reg.<span class="skw">find</span>(questionMark)
                    d(<span class="str">"click questionMark"</span>, questionMark)
                    <span class="skw">sleep</span>(<span class="dig">1.5</span>)
                    <span class="kw">return</span> True
                <span class="kw">else</span>:
                    firstSkill = reg.<span class="skw">find</span>(Pattern(<img src="1497757408206-4.png" />).similar(<span class="dig">0.65</span>))
                <span class="kw">if</span> bWaitFirstEp:
                    <span class="skw">sleep</span>(nDelayBeforeUsingSkill)
                    bWaitFirstEp = False
                <span class="kw">else</span>:
                    <span class="skw">sleep</span>(<span class="dig">0.5</span>)
                Debug.user(<span class="str">"use skill %d"</span>, n)
                firstSkill.x = <span class="dig">23</span>
                <span class="kw">if</span> n==-<span class="dig">1</span>:
                    useSkill(firstSkill.offset(<span class="dig">20</span>, -<span class="dig">80</span>))
                <span class="kw">elif</span> n == -<span class="dig">99</span>: <span class="cmt"># flee</span>
                    <span class="skw">click</span>(Location(<span class="dig">484</span>, <span class="dig">983</span>))
                    <span class="skw">sleep</span>(<span class="dig">1</span>)
                    <span class="skw">click</span>(Location(<span class="dig">275</span>, <span class="dig">617</span>))
                    waitFightingVanish(n*-<span class="dig">1</span>)
                <span class="kw">elif</span> n &lt;= -<span class="dig">2</span>: <span class="cmt">#sleep</span>
                    waitFightingVanish(n*-<span class="dig">1</span>)
                <span class="kw">else</span>:
                    useSkill(firstSkill.offset(<span class="dig">0</span>+n*<span class="dig">88</span>, <span class="dig">0</span>))
                    <span class="cmt">#d("burst bar", Pattern("1499732041383-1.png").similar(0.95), 0)</span>
                    <span class="cmt">#for i in range(10):</span>
                    <span class="cmt">#    if not isFighting():</span>
                    <span class="cmt">#        return False</span>
                    <span class="cmt">#    sleep(0.2)</span>
            <span class="kw">else</span>:
                <span class="kw">return</span> False

        <span class="cmt">#sleep(4)</span>
        <span class="cmt">#return True</span>
    <span class="kw">except</span> FindFailed:
        Debug.user(<span class="str">"can't find skill panel"</span>)
        clickMonster()
        <span class="kw">return</span> False

imageFindFriend = <img src="imageFindFriend.png" />
imageFriendOK = Pattern(<img src="imageFriendOK.png" />).similar(<span class="dig">0.90</span>)
imageClose = <img src="imageClose.png" />
imageGpsBonusRemind = <img src="imageGpsBonusRemind.png" />
imageGpsGo = <img src="imageGpsGo.png" />
<span class="kw">def</span> useGPS():
    reg = Region(<span class="dig">45</span>,<span class="dig">567</span>,<span class="dig">468</span>,<span class="dig">238</span>)
    <span class="kw">if</span> <span class="kw">not</span> d(<span class="str">"imageFindFriend"</span>, imageFindFriend, <span class="dig">3</span> ):
        d( <span class="str">"imageGo"</span>, imageGo, <span class="dig">5</span> )
        <span class="kw">return</span> False
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    imageFriendDialog = <img src="imageFriendDialog.png" />
    imageHasGpsFriend = <img src="imageHasUpsFriend.png" />
    <span class="kw">while</span> gameRegion.exists(imageFriendDialog, <span class="dig">1</span>):
        <span class="kw">if</span> <span class="kw">not</span> d( <span class="str">"imageHasUpsFriend"</span>, imageHasGpsFriend, <span class="dig">0</span> ):
            d(<span class="str">"imageFriendClose"</span>, imageClose, <span class="dig">2</span> )
        <span class="kw">else</span>:
            <span class="kw">if</span> reg.exists(imageGpsBonusRemind,<span class="dig">2</span>):
                d(<span class="str">"imageBonus1"</span>, imageBonus1)
                <span class="skw">sleep</span>(<span class="dig">1</span>)
                <span class="kw">if</span> reg.exists(imageGpsBonusRemind):
                    d(<span class="str">"imageBonus2"</span>, imageBonus2)
                <span class="kw">else</span>:
                    Debug.user(<span class="str">"no bonus 2"</span>)
            <span class="kw">else</span>:
                Debug.user(<span class="str">"no bonus 1"</span>)

    <span class="kw">if</span> bNeedUseOtherBranchServer:
        changeBranchServer()

    d(<span class="str">"no GPS service"</span>, <img src="1505642893410.png" />, <span class="dig">0</span>)

    d( <span class="str">"imageGo"</span>, imageGo, <span class="dig">2</span> )
    d( <span class="str">"imageGpsGo"</span>, imageGpsGo, <span class="dig">2</span> )
    <span class="kw">if</span> gameRegion.exists(Pattern(<img src="1505664145843.png" />).exact(), <span class="dig">0</span>):
        d(<span class="str">"GPS effect doesn't be used."</span>, Pattern(<img src="1505664202573.png" />).exact())

<span class="kw">def</span> moveALitte():
    Debug.user(<span class="str">"move a little"</span>)

    i=<span class="dig">0</span>
    <span class="kw">if</span> bMoveToBoss:
        Debug.user(<span class="str">"moveToBoss"</span>)
        <span class="kw">for</span> image <span class="kw">in</span> imageBoss:
            i = i+<span class="dig">1</span>
            Debug.user(<span class="str">"moveToBoss %d"</span> % i)
            <span class="kw">if</span> moveToMonster(image):
                <span class="skw">sleep</span>(<span class="dig">2</span>)

    <span class="kw">if</span> isOnMission():
        <span class="kw">for</span> n <span class="kw">in</span> range(<span class="dig">1</span>):
            <span class="skw">click</span>(locationUp)
            <span class="skw">sleep</span>(<span class="dig">0.5</span>)
            <span class="cmt">#click(locationDown)</span>
            <span class="cmt">#sleep(0.5)</span>

<span class="kw">def</span> fightToPartner():
    closeAnnouncement2()

    <span class="skw">click</span>( Location(<span class="dig">889</span>, <span class="dig">874</span>) )
    clickInRegion(gameRegion2, <img src="1500853416560.png" />)
    clickInRegion(gameRegion2, <img src="1498995557445.png" /> )
    clickInRegion(gameRegion2, <img src="1498995593560.png" /> )
    <span class="skw">sleep</span>(<span class="dig">5</span>)
    closeAnnouncement2()
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    d2( <span class="str">"skipp 2"</span>, <img src="1501177588703.png" />, <span class="dig">5</span> )
    <span class="skw">sleep</span>(<span class="dig">3</span>)
    <span class="cmt"># move a little</span>
    <span class="cmt">#click( Location(882, 537) )</span>



<span class="kw">def</span> transfer_evp():
    l(<span class="str">"move to talk"</span>, Location(<span class="dig">356</span>, <span class="dig">450</span>))

    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="kw">if</span> <span class="kw">not</span> d(<span class="str">"talk"</span>, <img src="1502317720357.png" />, <span class="dig">10</span>):
        l(<span class="str">"can't find the guard, click directly"</span>, Location(<span class="dig">304</span>, <span class="dig">510</span>))

    d(<span class="str">"talking"</span>, <img src="1502317910399.png" />, <span class="dig">5</span>)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    d(<span class="str">"talk to move other place"</span>, <img src="1502317951855.png" />, <span class="dig">5</span>)
    d(<span class="str">"talking2"</span>, <img src="1502317978971.png" />, <span class="dig">5</span>)
    <span class="cmt">#if enumType == enumEVP_6:</span>
    <span class="cmt">#    d("talk to move other place2", "1502318001566.png")</span>
    <span class="cmt">#else:</span>
    d(<span class="str">"talk to move other place2"</span>, <img src="1502368111955.png" />, <span class="dig">5</span>)
    <span class="skw">sleep</span>(<span class="dig">4</span>)

<span class="kw">def</span> transfer():
    Debug.user(<span class="str">"transfer"</span>);
    <span class="kw">if</span> <span class="kw">not</span> isOnMission():
        Debug.user(<span class="str">"error: no in a mission"</span>);

    l(<span class="str">"move to talk"</span>, Location(<span class="dig">343</span>, <span class="dig">501</span>))

    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="kw">if</span> <span class="kw">not</span> d(<span class="str">"talk"</span>, <img src="1502752563609.png" />, <span class="dig">10</span>):
        l(<span class="str">"can't find the guard, click directly"</span>, Location(<span class="dig">329</span>, <span class="dig">457</span>))

    d(<span class="str">"talking"</span>, <img src="1502752596473.png" />, <span class="dig">5</span>)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="kw">for</span> n <span class="kw">in</span> range(<span class="dig">2</span>):
        d(<span class="str">"talk to next page"</span>, <img src="1506294076568.png" />, <span class="dig">5</span>)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        d(<span class="str">"talking again"</span>, <img src="1502752596473.png" />, <span class="dig">5</span>)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
    d(<span class="str">"talk to move other place"</span>, <img src="1506294278905.png" />, <span class="dig">5</span>)
    d(<span class="str">"talking2"</span>, <img src="1506294351532.png" />, <span class="dig">5</span>)
    d(<span class="str">"talk to move other place2"</span>, <img src="1506294369543.png" />, <span class="dig">5</span>)
    <span class="skw">sleep</span>(<span class="dig">4</span>)
<span class="str">'''
    d("talk to move other place", "1502752617013.png", 5)
    d("talking2", "1502752630300.png", 5)

    #if enumType == enumEVP_6:
    #    d("talk to move other place2", "1502318001566.png", 5)
    #else:
    d("talk to move other place2", "1502752654221.png", 5)
    sleep(4)
'''</span>


<span class="kw">def</span> getPageId():
    Debug.user(<span class="str">"check page id (len=%d)"</span> % len(PageId.imagePages))
    <span class="kw">for</span> i <span class="kw">in</span> range( len(PageId.imagePages)):
        Debug.user(<span class="str">"check %s"</span> % PageId.imagePages[i][<span class="dig">3</span>])
        <span class="cmt">#print PageId.imagePages[i][0]</span>
        <span class="cmt">#PageId.imagePages[i][0].highlight(1)</span>
        <span class="kw">if</span> PageId.imagePages[i][<span class="dig">0</span>].exists( PageId.imagePages[i][<span class="dig">1</span>], <span class="dig">0</span>):
            Debug.user( PageId.imagePages[i][<span class="dig">3</span>] )
            <span class="kw">return</span> PageId.imagePages[i][<span class="dig">2</span>]

    <span class="cmt">#enumPageId_mission = 1</span>
    <span class="cmt">#enumPageId_fighting = 2</span>
    <span class="cmt">#enumPageId_again = 3</span>
    <span class="cmt">#enumPageId_board = 4  #看板</span>
    <span class="cmt">#enumPageId_unknown = 99</span>

    <span class="kw">return</span> PageId.enumPageId_unknown

<span class="kw">def</span> minimizeConsole():
    <span class="kw">if</span> gameRegion.exists(imageConsole):
        Debug.user(<span class="str">"found console"</span>)

<span class="kw">def</span> clickImageOffsetOrClickLocation(image, offsetX, offsetY, location):
    lib = GaeeryLib()
    lib.setRoi(gameRegion)
    loc = lib.<span class="skw">find</span>(<span class="str">"imageoffset"</span>, image, <span class="dig">1</span>)
    <span class="kw">if</span> loc == None:
        l(<span class="str">"move to a location instead"</span>, location)
    <span class="kw">else</span>:
        l(<span class="str">"click image offset"</span>, loc.offset(offsetX,offsetY) )

<span class="kw">def</span> moveToEvpTarget():


    <span class="cmt">#click(Location(265, 497))</span>

    <span class="cmt">#sleep(2)</span>
    <span class="cmt">#d("talk 1", "1512878584247.png", 5 )</span>
    <span class="cmt">#sleep(2)</span>
    <span class="cmt">#d("talk 2", "1512878584247.png", 5 )</span>
    <span class="cmt">#return d("start", "1512878613215.png", 5)</span>


    clickImageOffsetOrClickLocation( <img src="1508343277513.png" />, <span class="dig">130</span>, -<span class="dig">110</span>, Location(<span class="dig">515</span>, <span class="dig">426</span>) )  <span class="cmt">#wind</span>
    <span class="cmt">#clickImageOffsetOrClickLocation( Pattern("1507117402718.png").similar(0.95), 145, -60, Location(35, 394) )  #fire</span>
    <span class="cmt">#clickImageOffsetOrClickLocation( Pattern("1516451831116.png").similar(0.77), 110, -112, Location(56, 393) )  #dust</span>
    <span class="cmt">#clickImageOffsetOrClickLocation( Pattern("1516799459395.png").similar(0.90), 163, 53, Location(540, 486) )  #water</span>
    <span class="skw">sleep</span>(<span class="dig">1</span>)

    <span class="kw">if</span> isFighting():
        <span class="kw">return</span> True
    imageEnterEvpTarget = <img src="imageEnterEvpTarget.png" />
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="kw">if</span> d(<span class="str">"enter evp room?"</span>, imageEnterEvpTarget, <span class="dig">3</span>):
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="kw">if</span> d(<span class="str">"enter evp room"</span>, <img src="1505925536533.png" />, <span class="dig">3</span>):
            <span class="kw">return</span> True
    <span class="kw">return</span> False


checkKeyIndex = <span class="dig">0</span>
<span class="kw">def</span> checkKey():
    <span class="kw">global</span> checkKeyIndex

    checkKeyIndex = checkKeyIndex + <span class="dig">1</span>
    <span class="kw">if</span> checkKeyIndex % <span class="dig">5</span> != <span class="dig">0</span>:
        <span class="kw">return</span>

    <span class="kw">print</span> <span class="str">"open bag"</span>
    <span class="kw">if</span> clickInRegion(Region(<span class="dig">318</span>,<span class="dig">19</span>,<span class="dig">81</span>,<span class="dig">81</span>), Pattern(<img src="1518572898738.png" />).targetOffset(<span class="dig">76</span>,<span class="dig">4</span>)):
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="kw">if</span> gameRegion.exists(Pattern(<img src="1518573062836.png" />).similar(<span class="dig">0.91</span>), <span class="dig">2</span>):
            <span class="kw">return</span> True
        <span class="kw">elif</span> <span class="kw">not</span> Region(<span class="dig">444</span>,<span class="dig">146</span>,<span class="dig">114</span>,<span class="dig">773</span>).exists(Pattern(<img src="1518792136458.png" />).exact(), <span class="dig">0</span>):
            <span class="kw">print</span> <span class="str">"ZoomIn()"</span>

            zoomin()
            <span class="kw">if</span> gameRegion.exists(Pattern(<img src="1518573062836.png" />).similar(<span class="dig">0.91</span>), <span class="dig">2</span>):
                <span class="kw">return</span> True
    <span class="kw">print</span> <span class="str">"not find key"</span>
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    clickInRegion(Region(<span class="dig">318</span>,<span class="dig">19</span>,<span class="dig">81</span>,<span class="dig">81</span>), Pattern(<img src="1518572898738.png" />).targetOffset(<span class="dig">76</span>,<span class="dig">4</span>))
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="kw">return</span> False

g_bEnterBoxOnce = False
<span class="kw">def</span> moveToBox():
    <span class="kw">global</span> autoKills
    <span class="kw">global</span> g_bEnterBoxOnce
    <span class="kw">global</span> bMoveALittleAfterFight

    <span class="kw">if</span> checkKey():
        <span class="kw">print</span> <span class="str">"Found key"</span>
        <span class="skw">click</span>(Location(<span class="dig">512</span>, <span class="dig">58</span>))
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        clickInRegion(Region(<span class="dig">62</span>,<span class="dig">824</span>,<span class="dig">199</span>,<span class="dig">106</span>), <img src="1518573350026.png" />)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        clickInRegion(Region(<span class="dig">90</span>,<span class="dig">617</span>,<span class="dig">188</span>,<span class="dig">121</span>), <img src="1518573374299.png" /> )
        <span class="kw">return</span> False

    Debug.user(<span class="str">"moveToBox"</span>)


    bMoveALittleAfterFight = True
    <span class="cmt">#autoKills = [3,0,4,2,1]</span>
    autoKills = [<span class="dig">1</span>,<span class="dig">0</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>,<span class="dig">2</span>,<span class="dig">3</span>,<span class="dig">4</span>]
    <span class="kw">if</span> g_bEnterBoxOnce:
        monsters = Images( [ Pattern(<img src="1518572528396.png" />).targetOffset(-<span class="dig">441</span>,<span class="dig">77</span>), Pattern(<img src="1518886728546.png" />).targetOffset(<span class="dig">278</span>,-<span class="dig">281</span>), Pattern(<img src="1518912950318.png" />).targetOffset(-<span class="dig">93</span>,<span class="dig">160</span>), Pattern(<img src="1519140749303.png" />).targetOffset(-<span class="dig">158</span>,-<span class="dig">116</span>)] )
        <span class="cmt"># "1518571561279.png",Pattern("1518571574941.png").targetOffset(-17,46), "1518571601067.png",Pattern("1518791330254.png").targetOffset(-4,47), Pattern("1518884741731.png").targetOffset(-10,18),</span>
        <span class="kw">if</span> monsters.clickMatch():
            <span class="skw">sleep</span>(<span class="dig">3</span>)
    <span class="kw">else</span>:
        steps = Steps( <span class="str">"go to box"</span>, [Region(<span class="dig">0</span>,<span class="dig">92</span>,<span class="dig">553</span>,<span class="dig">795</span>), <img src="1518790009993.png" />, <img src="1518790021518.png" />, <img src="1518790035368.png" />, <span class="dig">6</span>, Location(<span class="dig">18</span>, <span class="dig">695</span>), <span class="dig">4</span>, Location(<span class="dig">271</span>, <span class="dig">514</span>), <span class="dig">1</span>, <img src="1518790164529.png" />, <img src="1518790177657.png" />], <span class="dig">1</span> )

        steps.execute()
        g_bEnterBoxOnce = True
        bMoveALittleAfterFight = False
        autoKills = [ <span class="dig">5</span>, <span class="dig">4</span>, -<span class="dig">99</span> ]
        <span class="cmt">#handMission = Images( [ Pattern("1518538641376.png").targetOffset(319,-202), Pattern("1518539888047.png").targetOffset(284,10), Pattern("1518539775831.png").similar(0.86).targetOffset(286,-34), Pattern("1518571955259.png").targetOffset(239,91), Pattern("1518572307492.png").similar(0.81)  ] )</span>
        <span class="cmt">#openBox = Steps("openbox", [ "1518540182888.png", "1518540244380.png" ], 2)</span>

        <span class="cmt">#handMission.setRoi(Region(6,32,537,782))</span>
        <span class="str">'''
        while True:
            if handMission.clickMatch():
                #autoKills = [ -99 ]
                sleep(3)
                continue
            sleep(1)
            while openBox.execute(): 
                # use 65
                g_bEnterBoxOnce = True
                autoKills = [ 5, 0, 1, -99 ]
                sleep(2)
            break        
        '''</span>
<span class="cmt">#moveToTaskTargetOnce()</span>
<span class="cmt">#fightToPartner()</span>
<span class="cmt">#moveALitte()</span>
<span class="cmt">#enterMission()</span>
<span class="cmt">#transfer()</span>
<span class="cmt">#enterAgain()</span>
refreshSetting()
<span class="kw">while</span> True:
    main()
</pre>
</body>
</html>
